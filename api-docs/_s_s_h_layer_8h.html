<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PcapPlusPlus: SSHLayer.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-mobile.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_icon_large.ico"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PcapPlusPlus
   &#160;<span id="projectnumber">20.08+</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_s_s_h_layer_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<div class="title">SSHLayer.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="_layer_8h_source.html">Layer.h</a>&quot;</code><br />
</div>
<p><a href="_s_s_h_layer_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpcpp_1_1_s_s_h_layer.html">pcpp::SSHLayer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpcpp_1_1_s_s_h_identification_message.html">pcpp::SSHIdentificationMessage</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpcpp_1_1_s_s_h_handshake_message.html">pcpp::SSHHandshakeMessage</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpcpp_1_1_s_s_h_handshake_message_1_1ssh__message__base.html">pcpp::SSHHandshakeMessage::ssh_message_base</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpcpp_1_1_s_s_h_key_exchange_init_message.html">pcpp::SSHKeyExchangeInitMessage</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpcpp_1_1_s_s_h_encrypted_message.html">pcpp::SSHEncryptedMessage</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacepcpp"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepcpp.html">pcpp</a></td></tr>
<tr class="memdesc:namespacepcpp"><td class="mdescLeft">&#160;</td><td class="mdescRight">The main namespace for the PcapPlusPlus lib. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file introduces classes and structures that represent the SSH (Secure Shell) protocol.</p>
<p>An overview of this protocol can be found here: <a href="https://en.wikipedia.org/wiki/Ssh_(Secure_Shell)">https://en.wikipedia.org/wiki/Ssh_(Secure_Shell)</a></p>
<p>For more details please refer to RFC 4253: <a href="https://tools.ietf.org/html/rfc4253">https://tools.ietf.org/html/rfc4253</a></p>
<p>These current implementation supports parsing of SSH packets when possible (meaning when they are not encrypted). Creation and editing of SSH packets is currently <b>not supported</b>.</p>
<p>SSH typically uses TCP port 22 so PcapPlusPlus assumes all traffic on this port is SSH traffic. PcapPlusPlus uses some heuristics to determine the type of the SSH message (which will be covered later). If it doesn't find a match to one of the other SSH messages, it assumes it is an encrypted SSH message.</p>
<p>Following is an overview of the SSH protocol classes currently supported in PcapPlusPlus. They cover the differnet messages of the SSH protocol:</p>
<pre class="fragment">                               +----------------------------+      SSH version identification
                           +---|  SSHIdentificationMessage  | ===&gt; as described here: 
                           |   +----------------------------+      https://tools.ietf.org/html/rfc4253#section-4.2
                           |
+------------+             |   +----------------------------+      SSH handshake message
|  SSHLayer  |-------------+---|  SSHHandshakeMessage       | ===&gt; which is typically one of the messages described here: 
| (abstract) |             |   +----------------------------+      https://tools.ietf.org/html/rfc4253#section-12
+------------+             |                 |
                           |                 |     +----------------------------+      SSH Key Exchange message
                           |                 +-----|  SSHKeyExchangeInitMessage | ===&gt; as described here:
                           |                       +----------------------------+      https://tools.ietf.org/html/rfc4253#section-7
                           |
                           |   +----------------------------+
                           +---|  SSHEncryptedMessage       | ===&gt; An encrypted SSH message
                               +----------------------------+</pre><p>The following points describe the heuristics for deciding the message type for each packet:</p><ol type="1">
<li>If the data starts with the characters "SSH-" and ends with "\n" (or "\r\n") it's assumed the message is of type <a class="el" href="classpcpp_1_1_s_s_h_identification_message.html">pcpp::SSHIdentificationMessage</a></li>
<li><p class="startli">Try to determine if this is a non-encrypted SSH handshake message:</p><ul>
<li>Look at the first 4 bytes of the data which may contain the packet length and see if the value is smaller of equal than the entire layer length</li>
<li>The next byte contains the padding length, check if it's smaller or equal than the packet length</li>
<li>The next byte contains the message type, check if the value is a valid message type as described in: <a href="https://tools.ietf.org/html/rfc4253#section-12">https://tools.ietf.org/html/rfc4253#section-12</a></li>
</ul>
<p class="startli">If all of these condition are met, this message is either <a class="el" href="classpcpp_1_1_s_s_h_key_exchange_init_message.html">pcpp::SSHKeyExchangeInitMessage</a> (if messsage type is <a class="el" href="classpcpp_1_1_s_s_h_handshake_message.html#a4dbb7d358bef567cfe920c90f0f72508ab6d105ca6f529a61846e4263ee25b64d">pcpp::SSHHandshakeMessage::SSH_MSG_KEX_INIT</a>) or <a class="el" href="classpcpp_1_1_s_s_h_handshake_message.html">pcpp::SSHHandshakeMessage</a> (for all other message types)</p>
</li>
<li>If non of these conditions are met, it is assumed this is an encrypted message (<a class="el" href="classpcpp_1_1_s_s_h_encrypted_message.html">pcpp::SSHEncryptedMessage</a>) </li>
</ol>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_de86beb0baec615108c189a95e2985e8.html">PcapPlusPlus</a></li><li class="navelem"><a class="el" href="dir_5651890ad0082dbf4dbb18c410c015c9.html">Dist</a></li><li class="navelem"><a class="el" href="dir_00034babc01e96e2748c521d6645ae1d.html">header</a></li><li class="navelem"><a class="el" href="_s_s_h_layer_8h.html">SSHLayer.h</a></li>
    <li class="footer">Generated on Mon Mar 29 2021 08:06:05 for PcapPlusPlus by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
