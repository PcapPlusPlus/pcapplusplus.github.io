<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PcapPlusPlus: pcpp::NetworkUtils Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-mobile.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_icon_large.ico"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PcapPlusPlus
   &#160;<span id="projectnumber">19.12</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classpcpp_1_1_network_utils.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="classpcpp_1_1_network_utils-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">pcpp::NetworkUtils Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_network_utils_8h_source.html">NetworkUtils.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a342e84b4e1c43657c8912b568b4344f2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpcpp_1_1_mac_address.html">MacAddress</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpcpp_1_1_network_utils.html#a342e84b4e1c43657c8912b568b4344f2">getMacAddress</a> (<a class="el" href="classpcpp_1_1_i_pv4_address.html">IPv4Address</a> ipAddr, <a class="el" href="classpcpp_1_1_pcap_live_device.html">PcapLiveDevice</a> *device, double &amp;arpResponseTimeMS, <a class="el" href="classpcpp_1_1_mac_address.html">MacAddress</a> sourceMac=<a class="el" href="classpcpp_1_1_mac_address.html#a1b210f1cf39a31d9ea947c57e6c65e2e">MacAddress::Zero</a>, <a class="el" href="classpcpp_1_1_i_pv4_address.html">IPv4Address</a> sourceIP=<a class="el" href="classpcpp_1_1_i_pv4_address.html#ab1fdcb75a0d28033e51770605ec978cb">IPv4Address::Zero</a>, int arpTimeout=-1) const</td></tr>
<tr class="separator:a342e84b4e1c43657c8912b568b4344f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a747c168000033ba2e8d005413843a546"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpcpp_1_1_i_pv4_address.html">IPv4Address</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpcpp_1_1_network_utils.html#a747c168000033ba2e8d005413843a546">getIPv4Address</a> (std::string hostname, <a class="el" href="classpcpp_1_1_pcap_live_device.html">PcapLiveDevice</a> *device, double &amp;dnsResponseTimeMS, uint32_t &amp;dnsTTL, int dnsTimeout=-1, <a class="el" href="classpcpp_1_1_i_pv4_address.html">IPv4Address</a> dnsServerIP=<a class="el" href="classpcpp_1_1_i_pv4_address.html#ab1fdcb75a0d28033e51770605ec978cb">IPv4Address::Zero</a>, <a class="el" href="classpcpp_1_1_i_pv4_address.html">IPv4Address</a> gatewayIP=<a class="el" href="classpcpp_1_1_i_pv4_address.html#ab1fdcb75a0d28033e51770605ec978cb">IPv4Address::Zero</a>) const</td></tr>
<tr class="separator:a747c168000033ba2e8d005413843a546"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ac0151f86bc3e98d50004bcf97d18517c"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classpcpp_1_1_network_utils.html">NetworkUtils</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpcpp_1_1_network_utils.html#ac0151f86bc3e98d50004bcf97d18517c">getInstance</a> ()</td></tr>
<tr class="separator:ac0151f86bc3e98d50004bcf97d18517c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a6c8310c11abf274e400a9b2be59ab873"><td class="memItemLeft" align="right" valign="top">static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpcpp_1_1_network_utils.html#a6c8310c11abf274e400a9b2be59ab873">DefaultTimeout</a></td></tr>
<tr class="separator:a6c8310c11abf274e400a9b2be59ab873"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class bundles several network utilities that are very common and useful. These utilities use Pcap++ and Packet++ packet crafting and processing capabilities. This class is a singleton and can be access by <a class="el" href="classpcpp_1_1_network_utils.html#ac0151f86bc3e98d50004bcf97d18517c">getInstance()</a> only </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ac0151f86bc3e98d50004bcf97d18517c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0151f86bc3e98d50004bcf97d18517c">&#9670;&nbsp;</a></span>getInstance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classpcpp_1_1_network_utils.html">NetworkUtils</a>&amp; pcpp::NetworkUtils::getInstance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The access method to the singleton </p><dl class="section return"><dt>Returns</dt><dd>The singleton instance of this class </dd></dl>

</div>
</div>
<a id="a747c168000033ba2e8d005413843a546"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a747c168000033ba2e8d005413843a546">&#9670;&nbsp;</a></span>getIPv4Address()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classpcpp_1_1_i_pv4_address.html">IPv4Address</a> pcpp::NetworkUtils::getIPv4Address </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>hostname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classpcpp_1_1_pcap_live_device.html">PcapLiveDevice</a> *&#160;</td>
          <td class="paramname"><em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>dnsResponseTimeMS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t &amp;&#160;</td>
          <td class="paramname"><em>dnsTTL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dnsTimeout</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classpcpp_1_1_i_pv4_address.html">IPv4Address</a>&#160;</td>
          <td class="paramname"><em>dnsServerIP</em> = <code><a class="el" href="classpcpp_1_1_i_pv4_address.html#ab1fdcb75a0d28033e51770605ec978cb">IPv4Address::Zero</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classpcpp_1_1_i_pv4_address.html">IPv4Address</a>&#160;</td>
          <td class="paramname"><em>gatewayIP</em> = <code><a class="el" href="classpcpp_1_1_i_pv4_address.html#ab1fdcb75a0d28033e51770605ec978cb">IPv4Address::Zero</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Resolve an IPv4 address for a given hostname. Resolving is done in multiple phases: first resolving the LAN gateway MAC address (or default gateway if a gateway isn't provided) using ARP protocol (by using <a class="el" href="classpcpp_1_1_network_utils.html#a342e84b4e1c43657c8912b568b4344f2">NetworkUtils::getMacAddress()</a> ). Then a DNS request is sent to a DNS server (if specified) or to the LAN gateway (if DNS server is not specified). The DNS response is decoded and the IPv4 address is determined. In addition the method outputs the time it took the DNS response to arrive and the DNS TTL written on the DNS response. If DNS response doesn't contain an IPv4 address resolving an <a class="el" href="classpcpp_1_1_i_pv4_address.html#ab1fdcb75a0d28033e51770605ec978cb">IPv4Address::Zero</a> will be returned. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hostname</td><td>The hostname to resolve </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">device</td><td>The interface to send and receive packets on </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dnsResponseTimeMS</td><td>When method returns successfully will contain the time it took to receive the DNS response (in milli-seconds) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dnsTTL</td><td>When method returns successfully will contain The DNS TTL written in the DNS response </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dnsTimeout</td><td>An optional parameter to specify the timeout to wait for a DNS response. If not specified the default timeout is 5 sec </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dnsServerIP</td><td>An optional parameter to specify the DNS server IP to send the DNS request to. If not specified or specified with <a class="el" href="classpcpp_1_1_i_pv4_address.html#ab1fdcb75a0d28033e51770605ec978cb">IPv4Address::Zero</a> the DNS request will be sent to the default DNS server configured in the system </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gatewayIP</td><td>An optional parameter to specify the LAN gateway to send the DNS request through. If not specified or specified with <a class="el" href="classpcpp_1_1_i_pv4_address.html#ab1fdcb75a0d28033e51770605ec978cb">IPv4Address::Zero</a> the interface's default gateway will be used </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The resolved IPv4 address or <a class="el" href="classpcpp_1_1_i_pv4_address.html#ab1fdcb75a0d28033e51770605ec978cb">IPv4Address::Zero</a> if something went wrong (in this case an error will be printed to log) </dd></dl>

</div>
</div>
<a id="a342e84b4e1c43657c8912b568b4344f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a342e84b4e1c43657c8912b568b4344f2">&#9670;&nbsp;</a></span>getMacAddress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classpcpp_1_1_mac_address.html">MacAddress</a> pcpp::NetworkUtils::getMacAddress </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classpcpp_1_1_i_pv4_address.html">IPv4Address</a>&#160;</td>
          <td class="paramname"><em>ipAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classpcpp_1_1_pcap_live_device.html">PcapLiveDevice</a> *&#160;</td>
          <td class="paramname"><em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>arpResponseTimeMS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classpcpp_1_1_mac_address.html">MacAddress</a>&#160;</td>
          <td class="paramname"><em>sourceMac</em> = <code><a class="el" href="classpcpp_1_1_mac_address.html#a1b210f1cf39a31d9ea947c57e6c65e2e">MacAddress::Zero</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classpcpp_1_1_i_pv4_address.html">IPv4Address</a>&#160;</td>
          <td class="paramname"><em>sourceIP</em> = <code><a class="el" href="classpcpp_1_1_i_pv4_address.html#ab1fdcb75a0d28033e51770605ec978cb">IPv4Address::Zero</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>arpTimeout</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Resolve the MAC address for a given IPv4 address. It's done using the ARP protocol: send an ARP request and interpret the response </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ipAddr</td><td>The IPv4 address to resolve MAC address to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">device</td><td>The interface to send and receive the ARP packets on </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">arpResponseTimeMS</td><td>An output parameter that will contain the time in milliseconds that took the ARP response to arrive </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sourceMac</td><td>An optional parameter to set the source MAC address that will be sent with the ARP request if this parameter isn't set or set with <a class="el" href="classpcpp_1_1_mac_address.html#a1b210f1cf39a31d9ea947c57e6c65e2e">MacAddress::Zero</a> the MAC address of the interface will be used </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sourceIP</td><td>An optional parameter to set the source IPv4 address that will be sent with the ARP request if this parameter isn't set or set with <a class="el" href="classpcpp_1_1_i_pv4_address.html#ab1fdcb75a0d28033e51770605ec978cb">IPv4Address::Zero</a> the default IPv4 address of the interface will be used </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">arpTimeout</td><td>An optional parameter to set the timeout to wait for the ARP response to return. If this parameter isn't set or set with a number smaller than 0, a default timeout of 5 seconds will be set </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The resolved MAC address or <a class="el" href="classpcpp_1_1_mac_address.html#a1b210f1cf39a31d9ea947c57e6c65e2e">MacAddress::Zero</a> if an error occurred or address could not be resolved. Errors will be printed to log </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a6c8310c11abf274e400a9b2be59ab873"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c8310c11abf274e400a9b2be59ab873">&#9670;&nbsp;</a></span>DefaultTimeout</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int pcpp::NetworkUtils::DefaultTimeout</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Default timeout used for several utilities. Currently set to 5 seconds </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacepcpp.html">pcpp</a></li><li class="navelem"><a class="el" href="classpcpp_1_1_network_utils.html">NetworkUtils</a></li>
    <li class="footer">Generated on Mon Dec 2 2019 23:53:23 for PcapPlusPlus by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
