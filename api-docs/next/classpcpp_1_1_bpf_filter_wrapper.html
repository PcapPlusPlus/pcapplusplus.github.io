<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PcapPlusPlus: pcpp::BpfFilterWrapper Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-mobile.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_icon_large.ico"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PcapPlusPlus
   &#160;<span id="projectnumber">Next</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classpcpp_1_1_bpf_filter_wrapper.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classpcpp_1_1_bpf_filter_wrapper-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">pcpp::BpfFilterWrapper Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_pcap_filter_8h_source.html">PcapFilter.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad16670c3937b6cae90ceb323a3678a57"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpcpp_1_1_bpf_filter_wrapper.html#ad16670c3937b6cae90ceb323a3678a57">BpfFilterWrapper</a> ()</td></tr>
<tr class="separator:ad16670c3937b6cae90ceb323a3678a57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af85beb3b454c64d7d259139fc0b77bd0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpcpp_1_1_bpf_filter_wrapper.html#af85beb3b454c64d7d259139fc0b77bd0">~BpfFilterWrapper</a> ()</td></tr>
<tr class="separator:af85beb3b454c64d7d259139fc0b77bd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6e6f30106eea22239f8f59eff701c33"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpcpp_1_1_bpf_filter_wrapper.html#ae6e6f30106eea22239f8f59eff701c33">setFilter</a> (const std::string &amp;filter, <a class="el" href="namespacepcpp.html#ab3f43dd3ccd8c93acac8b67909be02be">LinkLayerType</a> linkType=<a class="el" href="namespacepcpp.html#ab3f43dd3ccd8c93acac8b67909be02bea4a7bd3283e7f9b30aa9e71e7807de215">LINKTYPE_ETHERNET</a>)</td></tr>
<tr class="separator:ae6e6f30106eea22239f8f59eff701c33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cda4696a98a810756f1180cbdcef92c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpcpp_1_1_bpf_filter_wrapper.html#a0cda4696a98a810756f1180cbdcef92c">matchPacketWithFilter</a> (const <a class="el" href="classpcpp_1_1_raw_packet.html">RawPacket</a> *rawPacket)</td></tr>
<tr class="separator:a0cda4696a98a810756f1180cbdcef92c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a668957be8a54b518572a8daab36ee5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpcpp_1_1_bpf_filter_wrapper.html#a8a668957be8a54b518572a8daab36ee5">matchPacketWithFilter</a> (const uint8_t *packetData, uint32_t packetDataLength, timespec packetTimestamp, uint16_t linkType)</td></tr>
<tr class="separator:a8a668957be8a54b518572a8daab36ee5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A wrapper class for BPF filtering. Enables setting a BPF filter and matching it against a packet </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ad16670c3937b6cae90ceb323a3678a57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad16670c3937b6cae90ceb323a3678a57">&#9670;&nbsp;</a></span>BpfFilterWrapper()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pcpp::BpfFilterWrapper::BpfFilterWrapper </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A c'tor for this class </p>

</div>
</div>
<a id="af85beb3b454c64d7d259139fc0b77bd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af85beb3b454c64d7d259139fc0b77bd0">&#9670;&nbsp;</a></span>~BpfFilterWrapper()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pcpp::BpfFilterWrapper::~BpfFilterWrapper </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A d'tor for this class. Makes sure to clear the bpf_program object if was previously set. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a0cda4696a98a810756f1180cbdcef92c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cda4696a98a810756f1180cbdcef92c">&#9670;&nbsp;</a></span>matchPacketWithFilter() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool pcpp::BpfFilterWrapper::matchPacketWithFilter </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classpcpp_1_1_raw_packet.html">RawPacket</a> *&#160;</td>
          <td class="paramname"><em>rawPacket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Match a packet with the filter stored in this object. If the filter is empty the method returns "true". If the link type of the raw packet is different than the one set in <a class="el" href="classpcpp_1_1_bpf_filter_wrapper.html#ae6e6f30106eea22239f8f59eff701c33">setFilter()</a>, the filter will be re-compiled and stored in the object. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rawPacket</td><td>A pointer to a raw packet which the filter will be matched against </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the filter matches (or if it's empty). False if the packet doesn't match or if the filter could not be compiled </dd></dl>

</div>
</div>
<a id="a8a668957be8a54b518572a8daab36ee5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a668957be8a54b518572a8daab36ee5">&#9670;&nbsp;</a></span>matchPacketWithFilter() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool pcpp::BpfFilterWrapper::matchPacketWithFilter </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>packetData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>packetDataLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">timespec&#160;</td>
          <td class="paramname"><em>packetTimestamp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>linkType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Match a packet data with the filter stored in this object. If the filter is empty the method returns "true". If the link type provided is different than the one set in <a class="el" href="classpcpp_1_1_bpf_filter_wrapper.html#ae6e6f30106eea22239f8f59eff701c33">setFilter()</a>, the filter will be re-compiled and stored in the object. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">packetData</td><td>A byte stream containing the packet data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">packetDataLength</td><td>The length in [bytes] of the byte stream </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">packetTimestamp</td><td>The packet timestamp </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">linkType</td><td>The packet link type </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the filter matches (or if it's empty). False if the packet doesn't match or if the filter could not be compiled </dd></dl>

</div>
</div>
<a id="ae6e6f30106eea22239f8f59eff701c33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6e6f30106eea22239f8f59eff701c33">&#9670;&nbsp;</a></span>setFilter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool pcpp::BpfFilterWrapper::setFilter </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacepcpp.html#ab3f43dd3ccd8c93acac8b67909be02be">LinkLayerType</a>&#160;</td>
          <td class="paramname"><em>linkType</em> = <code><a class="el" href="namespacepcpp.html#ab3f43dd3ccd8c93acac8b67909be02bea4a7bd3283e7f9b30aa9e71e7807de215">LINKTYPE_ETHERNET</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set a filter. This method receives a filter in BPF syntax (<a href="https://biot.com/capstats/bpf.html">https://biot.com/capstats/bpf.html</a>) and an optional link type, compiles them, and if compilation is successful it stores the filter. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filter</td><td>A filter in BPF syntax </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">linkType</td><td>An optional parameter to set the filter's link type. The default is LINKTYPE_ETHERNET </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if compilation is successful and filter is stored in side this object, false otherwise </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacepcpp.html">pcpp</a></li><li class="navelem"><a class="el" href="classpcpp_1_1_bpf_filter_wrapper.html">BpfFilterWrapper</a></li>
    <li class="footer">Generated on Thu Jan 11 2024 09:49:26 for PcapPlusPlus by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
