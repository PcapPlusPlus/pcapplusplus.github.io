<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PcapPlusPlus: KniDevice.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-mobile.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_icon_large.ico"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PcapPlusPlus
   &#160;<span id="projectnumber">Next</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_kni_device_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">KniDevice.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_kni_device_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef PCAPPP_KNI_DEVICE</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define PCAPPP_KNI_DEVICE</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// GCOVR_EXCL_START</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;atomic&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_device_8h.html">Device.h</a>&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_mac_address_8h.html">MacAddress.h</a>&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;MBufRawPacket.h&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;LinuxNicInformationSocket.h&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="keyword">struct </span>rte_kni;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacepcpp.html">pcpp</a></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keyword">class </span>KniDevice;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keyword">class </span>KniDeviceList;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="namespacepcpp.html#a5d5c27837ffd86e49a6b4ce2cc1ed57b">   96</a></span>&#160;    <span class="keyword">typedef</span> bool (*<a class="code" href="namespacepcpp.html#a5d5c27837ffd86e49a6b4ce2cc1ed57b">OnKniPacketArriveCallback</a>)(<a class="code" href="classpcpp_1_1_m_buf_raw_packet.html">MBufRawPacket</a>* packets, uint32_t numOfPackets, <a class="code" href="classpcpp_1_1_kni_device.html">KniDevice</a>* device, <span class="keywordtype">void</span>* userCookie);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="classpcpp_1_1_kni_device.html">  123</a></span>&#160;    <span class="keyword">class </span><a class="code" href="classpcpp_1_1_kni_device.html">KniDevice</a> : <span class="keyword">public</span> <a class="code" href="classpcpp_1_1_i_device.html">IDevice</a></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classpcpp_1_1_kni_device_list.html">KniDeviceList</a>;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classpcpp_1_1_m_buf_raw_packet.html">MBufRawPacket</a>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keyword">public</span>:</div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329">  131</a></span>&#160;        <span class="keyword">enum</span> <a class="code" href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329">KniLinkState</a></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        {</div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329a404b3c5554c11081ce5b42f59d43bbd0">  134</a></span>&#160;            <a class="code" href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329a404b3c5554c11081ce5b42f59d43bbd0">LINK_NOT_SUPPORTED</a> = -2,</div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329ae13904b9463e2ccad7d7fc051e16591f">  136</a></span>&#160;            <a class="code" href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329ae13904b9463e2ccad7d7fc051e16591f">LINK_ERROR</a> = -1,</div><div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329a5f628c7179cabc3691ad5cd974667643">  138</a></span>&#160;            <a class="code" href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329a5f628c7179cabc3691ad5cd974667643">LINK_DOWN</a> = 0,</div><div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329a46ddb813939e1f5ada002c78996649f2">  140</a></span>&#160;            <a class="code" href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329a46ddb813939e1f5ada002c78996649f2">LINK_UP</a> = 1</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        };</div><div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="classpcpp_1_1_kni_device.html#a3fd22d62a55612b03481d65bc49fa0cc">  145</a></span>&#160;        <span class="keyword">enum</span> <a class="code" href="classpcpp_1_1_kni_device.html#a3fd22d62a55612b03481d65bc49fa0cc">KniInfoState</a></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        {</div><div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="classpcpp_1_1_kni_device.html#a3fd22d62a55612b03481d65bc49fa0cca4950a91c9a09ef0cced588928b501945">  148</a></span>&#160;            <a class="code" href="classpcpp_1_1_kni_device.html#a3fd22d62a55612b03481d65bc49fa0cca4950a91c9a09ef0cced588928b501945">INFO_CACHED</a> = 0,</div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classpcpp_1_1_kni_device.html#a3fd22d62a55612b03481d65bc49fa0ccad71b838937713cff4f1bbe10b2193ada">  150</a></span>&#160;            <a class="code" href="classpcpp_1_1_kni_device.html#a3fd22d62a55612b03481d65bc49fa0ccad71b838937713cff4f1bbe10b2193ada">INFO_RENEW</a> = 1</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        };</div><div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="classpcpp_1_1_kni_device.html#acfeed0b25fa073d8a74b2d29ca218dc6">  155</a></span>&#160;        <span class="keyword">enum</span> <a class="code" href="classpcpp_1_1_kni_device.html#acfeed0b25fa073d8a74b2d29ca218dc6">KniPromiscuousMode</a></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        {</div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="classpcpp_1_1_kni_device.html#acfeed0b25fa073d8a74b2d29ca218dc6af75609c56b3e20a626bde24b3867d2dd">  158</a></span>&#160;            <a class="code" href="classpcpp_1_1_kni_device.html#acfeed0b25fa073d8a74b2d29ca218dc6af75609c56b3e20a626bde24b3867d2dd">PROMISC_DISABLE</a> = 0,</div><div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="classpcpp_1_1_kni_device.html#acfeed0b25fa073d8a74b2d29ca218dc6ab03872103ed6bd45be0db9fe29683edd">  160</a></span>&#160;            <a class="code" href="classpcpp_1_1_kni_device.html#acfeed0b25fa073d8a74b2d29ca218dc6ab03872103ed6bd45be0db9fe29683edd">PROMISC_ENABLE</a> = 1</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        };</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks.html">  174</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks.html">KniIoctlCallbacks</a></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        {</div><div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks.html#a1af9caa75f5c83e134e2e606c648762c">  180</a></span>&#160;            int (*<a class="code" href="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks.html#a1af9caa75f5c83e134e2e606c648762c">change_mtu</a>)(uint16_t port_id, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> new_mtu);</div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks.html#aa7202b6797b63f0f1cb779db56056c35">  185</a></span>&#160;            int (*<a class="code" href="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks.html#aa7202b6797b63f0f1cb779db56056c35">config_network_if</a>)(uint16_t port_id, uint8_t if_up);</div><div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks.html#a935e5aa0c623107a4bf7088be436e68d">  193</a></span>&#160;            int (*<a class="code" href="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks.html#a935e5aa0c623107a4bf7088be436e68d">config_mac_address</a>)(uint16_t port_id, uint8_t mac_addr[]);</div><div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks.html#ac3b5330e4ee138f16b4be662250634a3">  201</a></span>&#160;            int (*<a class="code" href="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks.html#ac3b5330e4ee138f16b4be662250634a3">config_promiscusity</a>)(uint16_t port_id, uint8_t to_on);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        };</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="structpcpp_1_1_kni_device_1_1_kni_old_ioctl_callbacks.html">  211</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="structpcpp_1_1_kni_device_1_1_kni_old_ioctl_callbacks.html">KniOldIoctlCallbacks</a></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        {</div><div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="structpcpp_1_1_kni_device_1_1_kni_old_ioctl_callbacks.html#a7536ecfac6ecb14edc740e603b5c1e72">  217</a></span>&#160;            int (*<a class="code" href="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks.html#a1af9caa75f5c83e134e2e606c648762c">change_mtu</a>)(uint8_t port_id, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> new_mtu);</div><div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="structpcpp_1_1_kni_device_1_1_kni_old_ioctl_callbacks.html#ab548ab7f397d18a78a767225f9fb3192">  222</a></span>&#160;            int (*<a class="code" href="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks.html#aa7202b6797b63f0f1cb779db56056c35">config_network_if</a>)(uint8_t port_id, uint8_t if_up);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        };</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html">  231</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html">KniDeviceConfiguration</a></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        {</div><div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html#a2df48dfa7610b8e97f48a46403feb4c4">  238</a></span>&#160;            std::string <a class="code" href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html#a2df48dfa7610b8e97f48a46403feb4c4">name</a>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="keyword">union</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            {</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <a class="code" href="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks.html">KniIoctlCallbacks</a>* callbacks;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <a class="code" href="structpcpp_1_1_kni_device_1_1_kni_old_ioctl_callbacks.html">KniOldIoctlCallbacks</a>* oldCallbacks;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            };</div><div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html#a971b099355d4da2fc8f85224f50ed42c">  250</a></span>&#160;            <a class="code" href="classpcpp_1_1_mac_address.html">MacAddress</a> <a class="code" href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html#a971b099355d4da2fc8f85224f50ed42c">mac</a>;</div><div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html#a22df3fac00ba8927f0554bf970e389ac">  257</a></span>&#160;            uint16_t <a class="code" href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html#a22df3fac00ba8927f0554bf970e389ac">portId</a>;</div><div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html#a367e9fa4227ef174aff1f4c9a0f85ab6">  259</a></span>&#160;            uint16_t <a class="code" href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html#a367e9fa4227ef174aff1f4c9a0f85ab6">mtu</a>;</div><div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html#a75e4fec9e87b52e390e1d79e3d8e6dd6">  267</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html#a75e4fec9e87b52e390e1d79e3d8e6dd6">bindKthread</a>;</div><div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html#a4e04ae1b8e56cb5cfe523dea16113d1b">  269</a></span>&#160;            uint32_t <a class="code" href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html#a4e04ae1b8e56cb5cfe523dea16113d1b">kthreadCoreId</a>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        };</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keyword">private</span>:</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <a class="code" href="classpcpp_1_1_kni_device.html">KniDevice</a>(<span class="keyword">const</span> <a class="code" href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html">KniDeviceConfiguration</a>&amp; conf, <span class="keywordtype">size_t</span> mempoolSize, <span class="keywordtype">int</span> unique);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <a class="code" href="classpcpp_1_1_kni_device.html">KniDevice</a>(<span class="keyword">const</span> <a class="code" href="classpcpp_1_1_kni_device.html">KniDevice</a>&amp;);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <a class="code" href="classpcpp_1_1_kni_device.html">KniDevice</a>&amp; operator=(<span class="keyword">const</span> <a class="code" href="classpcpp_1_1_kni_device.html">KniDevice</a>&amp;);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        ~<a class="code" href="classpcpp_1_1_kni_device.html">KniDevice</a>();</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keyword">public</span>:</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="comment">/* Information getters */</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="classpcpp_1_1_kni_device.html#a40f81fc75157860db3c6ff93c70e228f">  288</a></span>&#160;        <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classpcpp_1_1_kni_device.html#a40f81fc75157860db3c6ff93c70e228f">isInitialized</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !(m_Device == NULL || m_MBufMempool == NULL); }</div><div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="classpcpp_1_1_kni_device.html#a313c357df59ca65f3c390f9bc2dd98d1">  292</a></span>&#160;        <span class="keyword">inline</span> std::string <a class="code" href="classpcpp_1_1_kni_device.html#a313c357df59ca65f3c390f9bc2dd98d1">getName</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> std::string(m_DeviceInfo.name); }</div><div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="classpcpp_1_1_kni_device.html#aa4d4d8536d5fecfd9ab99a8c92b41971">  296</a></span>&#160;        <span class="keyword">inline</span> uint16_t <a class="code" href="classpcpp_1_1_kni_device.html#aa4d4d8536d5fecfd9ab99a8c92b41971">getPort</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_DeviceInfo.portId; }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <a class="code" href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329">KniLinkState</a> <a class="code" href="classpcpp_1_1_kni_device.html#a65ad16846869b52da79397723cd4e691">getLinkState</a>(<a class="code" href="classpcpp_1_1_kni_device.html#a3fd22d62a55612b03481d65bc49fa0cc">KniInfoState</a> state = <a class="code" href="classpcpp_1_1_kni_device.html#a3fd22d62a55612b03481d65bc49fa0cca4950a91c9a09ef0cced588928b501945">INFO_CACHED</a>);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <a class="code" href="classpcpp_1_1_mac_address.html">MacAddress</a> <a class="code" href="classpcpp_1_1_kni_device.html#a5a5025025675c14d984adde60a3f0c37">getMacAddress</a>(<a class="code" href="classpcpp_1_1_kni_device.html#a3fd22d62a55612b03481d65bc49fa0cc">KniInfoState</a> state = <a class="code" href="classpcpp_1_1_kni_device.html#a3fd22d62a55612b03481d65bc49fa0cca4950a91c9a09ef0cced588928b501945">INFO_CACHED</a>);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        uint16_t <a class="code" href="classpcpp_1_1_kni_device.html#ae95905dfcd2e5aac787e03571cb9fdac">getMtu</a>(<a class="code" href="classpcpp_1_1_kni_device.html#a3fd22d62a55612b03481d65bc49fa0cc">KniInfoState</a> state = <a class="code" href="classpcpp_1_1_kni_device.html#a3fd22d62a55612b03481d65bc49fa0cca4950a91c9a09ef0cced588928b501945">INFO_CACHED</a>);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <a class="code" href="classpcpp_1_1_kni_device.html#acfeed0b25fa073d8a74b2d29ca218dc6">KniPromiscuousMode</a> <a class="code" href="classpcpp_1_1_kni_device.html#a24e3a5fcb269c6b12ce943fc4e000bde">getPromiscuous</a>(<a class="code" href="classpcpp_1_1_kni_device.html#a3fd22d62a55612b03481d65bc49fa0cc">KniInfoState</a> state = <a class="code" href="classpcpp_1_1_kni_device.html#a3fd22d62a55612b03481d65bc49fa0cca4950a91c9a09ef0cced588928b501945">INFO_CACHED</a>);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="comment">/* Information setters */</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classpcpp_1_1_kni_device.html#aa16790972282b1abaf1116dc6cd32355">setLinkState</a>(<a class="code" href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329">KniLinkState</a> state);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classpcpp_1_1_kni_device.html#a6baf3b2af2d5edd81e85d57a7a7a5ae3">setMacAddress</a>(<a class="code" href="classpcpp_1_1_mac_address.html">MacAddress</a> mac);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classpcpp_1_1_kni_device.html#a84eb855f4a1ca4df14d23374b752edd6">setMtu</a>(uint16_t mtu);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classpcpp_1_1_kni_device.html#a4ca4642ca8d30d931a084c7582aa3a6b">setPromiscuous</a>(<a class="code" href="classpcpp_1_1_kni_device.html#acfeed0b25fa073d8a74b2d29ca218dc6">KniPromiscuousMode</a> mode);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <a class="code" href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329">KniLinkState</a> <a class="code" href="classpcpp_1_1_kni_device.html#a4d0c0eb6a3dee13f287d0d72e2aa8b9c">updateLinkState</a>(<a class="code" href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329">KniLinkState</a> state);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="comment">/* Requests */</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classpcpp_1_1_kni_device.html#ab1c0ad9cc41211075af60930dc591d8e">handleRequests</a>();</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classpcpp_1_1_kni_device.html#aea9f67921e83cd832cbfc4eadb96855b">startRequestHandlerThread</a>(<span class="keywordtype">long</span> sleepSeconds, <span class="keywordtype">long</span> sleepNanoSeconds = 0);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classpcpp_1_1_kni_device.html#a9ea262da8ecc907b834fe7892241578e">stopRequestHandlerThread</a>();</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="comment">/* Packet receive */</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        uint16_t <a class="code" href="classpcpp_1_1_kni_device.html#a85fadba90e945dcbb8915684f862e483">receivePackets</a>(<a class="code" href="classpcpp_1_1_pointer_vector.html">MBufRawPacketVector</a>&amp; rawPacketsArr);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        uint16_t <a class="code" href="classpcpp_1_1_kni_device.html#a85fadba90e945dcbb8915684f862e483">receivePackets</a>(<a class="code" href="classpcpp_1_1_m_buf_raw_packet.html">MBufRawPacket</a>** rawPacketsArr, uint16_t rawPacketArrLength);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        uint16_t <a class="code" href="classpcpp_1_1_kni_device.html#a85fadba90e945dcbb8915684f862e483">receivePackets</a>(<a class="code" href="classpcpp_1_1_packet.html">Packet</a>** packetsArr, uint16_t packetsArrLength);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="comment">/* Packet send */</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        uint16_t <a class="code" href="classpcpp_1_1_kni_device.html#ab9881c7b4a577be790dfee9e8b6a8e19">sendPackets</a>(<a class="code" href="classpcpp_1_1_m_buf_raw_packet.html">MBufRawPacket</a>** rawPacketsArr, uint16_t arrLength);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        uint16_t <a class="code" href="classpcpp_1_1_kni_device.html#ab9881c7b4a577be790dfee9e8b6a8e19">sendPackets</a>(<a class="code" href="classpcpp_1_1_packet.html">Packet</a>** packetsArr, uint16_t arrLength);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        uint16_t <a class="code" href="classpcpp_1_1_kni_device.html#ab9881c7b4a577be790dfee9e8b6a8e19">sendPackets</a>(<a class="code" href="classpcpp_1_1_pointer_vector.html">MBufRawPacketVector</a>&amp; rawPacketsVec);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        uint16_t <a class="code" href="classpcpp_1_1_kni_device.html#ab9881c7b4a577be790dfee9e8b6a8e19">sendPackets</a>(<a class="code" href="classpcpp_1_1_pointer_vector.html">RawPacketVector</a>&amp; rawPacketsVec);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classpcpp_1_1_kni_device.html#a1b7d681b5e1128f4f0c63d71eca31621">sendPacket</a>(<a class="code" href="classpcpp_1_1_raw_packet.html">RawPacket</a>&amp; rawPacket);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classpcpp_1_1_kni_device.html#a1b7d681b5e1128f4f0c63d71eca31621">sendPacket</a>(<a class="code" href="classpcpp_1_1_m_buf_raw_packet.html">MBufRawPacket</a>&amp; rawPacket);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classpcpp_1_1_kni_device.html#a1b7d681b5e1128f4f0c63d71eca31621">sendPacket</a>(<a class="code" href="classpcpp_1_1_packet.html">Packet</a>&amp; packet);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="comment">/* Packet capture */</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classpcpp_1_1_kni_device.html#a3f5f48e1e2950cb3f2385d1bdda5a25e">startCapture</a>(<a class="code" href="namespacepcpp.html#a5d5c27837ffd86e49a6b4ce2cc1ed57b">OnKniPacketArriveCallback</a> onPacketArrives, <span class="keywordtype">void</span>* onPacketArrivesUserCookie);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classpcpp_1_1_kni_device.html#a7039519dc1d34590bb4a8b31ebc3ffe2">startCaptureBlockingMode</a>(<a class="code" href="namespacepcpp.html#a5d5c27837ffd86e49a6b4ce2cc1ed57b">OnKniPacketArriveCallback</a> onPacketArrives, <span class="keywordtype">void</span>* onPacketArrivesUserCookie, <span class="keywordtype">int</span> timeout);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classpcpp_1_1_kni_device.html#aacdb5298cdb0fa1cc8a3563ef91e2546">stopCapture</a>();</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="comment">/* Device control */</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classpcpp_1_1_kni_device.html#a2f66da689a3403a98d3d4f735b79cc50">open</a>();</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classpcpp_1_1_kni_device.html#af1d2bdcdd4ec0ab6db3754af10f0c541">close</a>();</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keyword">private</span>:</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="keyword">struct </span>rte_kni* m_Device;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keyword">struct </span>rte_mempool* m_MBufMempool;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="keyword">struct </span>KniDeviceInfo</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            <a class="code" href="classpcpp_1_1_linux_nic_information_socket.html">LinuxNicInformationSocket</a> soc;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <a class="code" href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329">KniLinkState</a> link;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            <a class="code" href="classpcpp_1_1_kni_device.html#acfeed0b25fa073d8a74b2d29ca218dc6">KniPromiscuousMode</a> promisc;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            uint16_t portId;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            uint16_t mtu;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <a class="code" href="classpcpp_1_1_mac_address.html">MacAddress</a> mac;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            std::string name;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <span class="keywordtype">bool</span> init(<span class="keyword">const</span> <a class="code" href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html">KniDeviceConfiguration</a>&amp; conf);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        } m_DeviceInfo;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="keyword">struct </span>KniThread;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keyword">struct </span>KniCapturing</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        {</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            <a class="code" href="namespacepcpp.html#a5d5c27837ffd86e49a6b4ce2cc1ed57b">OnKniPacketArriveCallback</a> callback;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="keywordtype">void</span>* userCookie;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            KniThread* thread;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            <span class="keyword">static</span> <span class="keywordtype">void</span> runCapture(<span class="keywordtype">void</span>* devicePointer, std::atomic&lt;bool&gt;&amp; stopThread);</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            <span class="keyword">inline</span> <span class="keywordtype">bool</span> isRunning()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> thread != NULL; }</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <span class="keywordtype">void</span> cleanup();</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        } m_Capturing;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keyword">struct </span>KniRequests</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <span class="keywordtype">long</span> sleepS;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <span class="keywordtype">long</span> sleepNs;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            KniThread* thread;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            <span class="keyword">static</span> <span class="keywordtype">void</span> runRequests(<span class="keywordtype">void</span>* devicePointer, std::atomic&lt;bool&gt;&amp; stopThread);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            <span class="keywordtype">void</span> cleanup();</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        } m_Requests;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    };</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;} <span class="comment">// namespace pcpp</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">// GCOVR_EXCL_STOP</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* PCAPPP_KNI_DEVICE */</span><span class="preprocessor"></span></div><div class="ttc" id="namespacepcpp_html"><div class="ttname"><a href="namespacepcpp.html">pcpp</a></div><div class="ttdoc">The main namespace for the PcapPlusPlus lib. </div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_acfeed0b25fa073d8a74b2d29ca218dc6af75609c56b3e20a626bde24b3867d2dd"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#acfeed0b25fa073d8a74b2d29ca218dc6af75609c56b3e20a626bde24b3867d2dd">pcpp::KniDevice::PROMISC_DISABLE</a></div><div class="ttdef"><b>Definition:</b> KniDevice.h:158</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a24e3a5fcb269c6b12ce943fc4e000bde"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a24e3a5fcb269c6b12ce943fc4e000bde">pcpp::KniDevice::getPromiscuous</a></div><div class="ttdeci">KniPromiscuousMode getPromiscuous(KniInfoState state=INFO_CACHED)</div><div class="ttdoc">Obtains information about promiscuous mode of KNI device. If called with INFO_CACHED - returns cached...</div></div>
<div class="ttc" id="_device_8h_html"><div class="ttname"><a href="_device_8h.html">Device.h</a></div></div>
<div class="ttc" id="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks_html_a1af9caa75f5c83e134e2e606c648762c"><div class="ttname"><a href="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks.html#a1af9caa75f5c83e134e2e606c648762c">pcpp::KniDevice::KniIoctlCallbacks::change_mtu</a></div><div class="ttdeci">int(* change_mtu)(uint16_t port_id, unsigned int new_mtu)</div><div class="ttdef"><b>Definition:</b> KniDevice.h:180</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html"><div class="ttname"><a href="classpcpp_1_1_kni_device.html">pcpp::KniDevice</a></div><div class="ttdef"><b>Definition:</b> KniDevice.h:123</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_af1d2bdcdd4ec0ab6db3754af10f0c541"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#af1d2bdcdd4ec0ab6db3754af10f0c541">pcpp::KniDevice::close</a></div><div class="ttdeci">void close()</div><div class="ttdoc">Close the KNI device. When device is closed it&amp;#39;s not possible to work with it. Stops asynchronous pac...</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a9a016df4487ece71c8dc911961a4f329a5f628c7179cabc3691ad5cd974667643"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329a5f628c7179cabc3691ad5cd974667643">pcpp::KniDevice::LINK_DOWN</a></div><div class="ttdef"><b>Definition:</b> KniDevice.h:138</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a3f5f48e1e2950cb3f2385d1bdda5a25e"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a3f5f48e1e2950cb3f2385d1bdda5a25e">pcpp::KniDevice::startCapture</a></div><div class="ttdeci">bool startCapture(OnKniPacketArriveCallback onPacketArrives, void *onPacketArrivesUserCookie)</div><div class="ttdoc">Start capturing packets asynchronously on this KNI interface. Each time a burst of packets is capture...</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a4ca4642ca8d30d931a084c7582aa3a6b"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a4ca4642ca8d30d931a084c7582aa3a6b">pcpp::KniDevice::setPromiscuous</a></div><div class="ttdeci">bool setPromiscuous(KniPromiscuousMode mode)</div><div class="ttdoc">Sets promiscuous mode of KNI device. Firstly the promiscuous mode information is updated as by call t...</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a3fd22d62a55612b03481d65bc49fa0cc"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a3fd22d62a55612b03481d65bc49fa0cc">pcpp::KniDevice::KniInfoState</a></div><div class="ttdeci">KniInfoState</div><div class="ttdef"><b>Definition:</b> KniDevice.h:145</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_ae95905dfcd2e5aac787e03571cb9fdac"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#ae95905dfcd2e5aac787e03571cb9fdac">pcpp::KniDevice::getMtu</a></div><div class="ttdeci">uint16_t getMtu(KniInfoState state=INFO_CACHED)</div><div class="ttdoc">Obtains MTU of KNI device. If called with INFO_CACHED - returns cached data about MTU (SUPER FAST may...</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a3fd22d62a55612b03481d65bc49fa0ccad71b838937713cff4f1bbe10b2193ada"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a3fd22d62a55612b03481d65bc49fa0ccad71b838937713cff4f1bbe10b2193ada">pcpp::KniDevice::INFO_RENEW</a></div><div class="ttdef"><b>Definition:</b> KniDevice.h:150</div></div>
<div class="ttc" id="classpcpp_1_1_packet_html"><div class="ttname"><a href="classpcpp_1_1_packet.html">pcpp::Packet</a></div><div class="ttdef"><b>Definition:</b> Packet.h:26</div></div>
<div class="ttc" id="structpcpp_1_1_kni_device_1_1_kni_device_configuration_html_a75e4fec9e87b52e390e1d79e3d8e6dd6"><div class="ttname"><a href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html#a75e4fec9e87b52e390e1d79e3d8e6dd6">pcpp::KniDevice::KniDeviceConfiguration::bindKthread</a></div><div class="ttdeci">bool bindKthread</div><div class="ttdef"><b>Definition:</b> KniDevice.h:267</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a40f81fc75157860db3c6ff93c70e228f"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a40f81fc75157860db3c6ff93c70e228f">pcpp::KniDevice::isInitialized</a></div><div class="ttdeci">bool isInitialized() const</div><div class="ttdef"><b>Definition:</b> KniDevice.h:288</div></div>
<div class="ttc" id="classpcpp_1_1_pointer_vector_html"><div class="ttname"><a href="classpcpp_1_1_pointer_vector.html">pcpp::PointerVector</a></div><div class="ttdef"><b>Definition:</b> PointerVector.h:24</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a5a5025025675c14d984adde60a3f0c37"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a5a5025025675c14d984adde60a3f0c37">pcpp::KniDevice::getMacAddress</a></div><div class="ttdeci">MacAddress getMacAddress(KniInfoState state=INFO_CACHED)</div><div class="ttdoc">Obtains MAC address of KNI device. If called with INFO_CACHED - returns cached data about MAC address...</div></div>
<div class="ttc" id="classpcpp_1_1_raw_packet_html"><div class="ttname"><a href="classpcpp_1_1_raw_packet.html">pcpp::RawPacket</a></div><div class="ttdef"><b>Definition:</b> RawPacket.h:254</div></div>
<div class="ttc" id="classpcpp_1_1_i_device_html"><div class="ttname"><a href="classpcpp_1_1_i_device.html">pcpp::IDevice</a></div><div class="ttdef"><b>Definition:</b> Device.h:24</div></div>
<div class="ttc" id="classpcpp_1_1_linux_nic_information_socket_html"><div class="ttname"><a href="classpcpp_1_1_linux_nic_information_socket.html">pcpp::LinuxNicInformationSocket</a></div><div class="ttdef"><b>Definition:</b> LinuxNicInformationSocket.h:26</div></div>
<div class="ttc" id="structpcpp_1_1_kni_device_1_1_kni_device_configuration_html_a4e04ae1b8e56cb5cfe523dea16113d1b"><div class="ttname"><a href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html#a4e04ae1b8e56cb5cfe523dea16113d1b">pcpp::KniDevice::KniDeviceConfiguration::kthreadCoreId</a></div><div class="ttdeci">uint32_t kthreadCoreId</div><div class="ttdef"><b>Definition:</b> KniDevice.h:269</div></div>
<div class="ttc" id="classpcpp_1_1_m_buf_raw_packet_html"><div class="ttname"><a href="classpcpp_1_1_m_buf_raw_packet.html">pcpp::MBufRawPacket</a></div><div class="ttdef"><b>Definition:</b> MBufRawPacket.h:47</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_aea9f67921e83cd832cbfc4eadb96855b"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#aea9f67921e83cd832cbfc4eadb96855b">pcpp::KniDevice::startRequestHandlerThread</a></div><div class="ttdeci">bool startRequestHandlerThread(long sleepSeconds, long sleepNanoSeconds=0)</div><div class="ttdoc">Starts new thread (using pthread) to asynchronously handle KNI device requests. See description of ha...</div></div>
<div class="ttc" id="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks_html_ac3b5330e4ee138f16b4be662250634a3"><div class="ttname"><a href="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks.html#ac3b5330e4ee138f16b4be662250634a3">pcpp::KniDevice::KniIoctlCallbacks::config_promiscusity</a></div><div class="ttdeci">int(* config_promiscusity)(uint16_t port_id, uint8_t to_on)</div><div class="ttdef"><b>Definition:</b> KniDevice.h:201</div></div>
<div class="ttc" id="namespacepcpp_html_a5d5c27837ffd86e49a6b4ce2cc1ed57b"><div class="ttname"><a href="namespacepcpp.html#a5d5c27837ffd86e49a6b4ce2cc1ed57b">pcpp::OnKniPacketArriveCallback</a></div><div class="ttdeci">bool(* OnKniPacketArriveCallback)(MBufRawPacket *packets, uint32_t numOfPackets, KniDevice *device, void *userCookie)</div><div class="ttdef"><b>Definition:</b> KniDevice.h:96</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a9a016df4487ece71c8dc911961a4f329"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329">pcpp::KniDevice::KniLinkState</a></div><div class="ttdeci">KniLinkState</div><div class="ttdef"><b>Definition:</b> KniDevice.h:131</div></div>
<div class="ttc" id="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks_html"><div class="ttname"><a href="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks.html">pcpp::KniDevice::KniIoctlCallbacks</a></div><div class="ttdoc">New callbacks for KNI device events. This structure MUST be used ONLY when KniDeviceList::callbackVer...</div><div class="ttdef"><b>Definition:</b> KniDevice.h:174</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a65ad16846869b52da79397723cd4e691"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a65ad16846869b52da79397723cd4e691">pcpp::KniDevice::getLinkState</a></div><div class="ttdeci">KniLinkState getLinkState(KniInfoState state=INFO_CACHED)</div><div class="ttdoc">Obtains link status of KNI device. If called with INFO_CACHED - returns cached data about link state ...</div></div>
<div class="ttc" id="structpcpp_1_1_kni_device_1_1_kni_old_ioctl_callbacks_html"><div class="ttname"><a href="structpcpp_1_1_kni_device_1_1_kni_old_ioctl_callbacks.html">pcpp::KniDevice::KniOldIoctlCallbacks</a></div><div class="ttdoc">Old callbacks for KNI device events. This structure MUST be used ONLY when KniDeviceList::callbackVer...</div><div class="ttdef"><b>Definition:</b> KniDevice.h:211</div></div>
<div class="ttc" id="structpcpp_1_1_kni_device_1_1_kni_device_configuration_html_a971b099355d4da2fc8f85224f50ed42c"><div class="ttname"><a href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html#a971b099355d4da2fc8f85224f50ed42c">pcpp::KniDevice::KniDeviceConfiguration::mac</a></div><div class="ttdeci">MacAddress mac</div><div class="ttdef"><b>Definition:</b> KniDevice.h:250</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a7039519dc1d34590bb4a8b31ebc3ffe2"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a7039519dc1d34590bb4a8b31ebc3ffe2">pcpp::KniDevice::startCaptureBlockingMode</a></div><div class="ttdeci">int startCaptureBlockingMode(OnKniPacketArriveCallback onPacketArrives, void *onPacketArrivesUserCookie, int timeout)</div><div class="ttdoc">Start capturing packets synchronously on this KNI interface in blocking mode. Blocking mode means tha...</div></div>
<div class="ttc" id="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks_html_aa7202b6797b63f0f1cb779db56056c35"><div class="ttname"><a href="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks.html#aa7202b6797b63f0f1cb779db56056c35">pcpp::KniDevice::KniIoctlCallbacks::config_network_if</a></div><div class="ttdeci">int(* config_network_if)(uint16_t port_id, uint8_t if_up)</div><div class="ttdef"><b>Definition:</b> KniDevice.h:185</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a9a016df4487ece71c8dc911961a4f329ae13904b9463e2ccad7d7fc051e16591f"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329ae13904b9463e2ccad7d7fc051e16591f">pcpp::KniDevice::LINK_ERROR</a></div><div class="ttdef"><b>Definition:</b> KniDevice.h:136</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_ab1c0ad9cc41211075af60930dc591d8e"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#ab1c0ad9cc41211075af60930dc591d8e">pcpp::KniDevice::handleRequests</a></div><div class="ttdeci">bool handleRequests()</div><div class="ttdoc">Handle requests from Linux kernel synchronously in calling thread. When one of events which is needed...</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a2f66da689a3403a98d3d4f735b79cc50"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a2f66da689a3403a98d3d4f735b79cc50">pcpp::KniDevice::open</a></div><div class="ttdeci">bool open()</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_list_html"><div class="ttname"><a href="classpcpp_1_1_kni_device_list.html">pcpp::KniDeviceList</a></div><div class="ttdef"><b>Definition:</b> KniDeviceList.h:24</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a4d0c0eb6a3dee13f287d0d72e2aa8b9c"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a4d0c0eb6a3dee13f287d0d72e2aa8b9c">pcpp::KniDevice::updateLinkState</a></div><div class="ttdeci">KniLinkState updateLinkState(KniLinkState state)</div><div class="ttdoc">Updates link state of KNI device. Unconditionally updates link state of KNI device via call to DPDK l...</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a6baf3b2af2d5edd81e85d57a7a7a5ae3"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a6baf3b2af2d5edd81e85d57a7a7a5ae3">pcpp::KniDevice::setMacAddress</a></div><div class="ttdeci">bool setMacAddress(MacAddress mac)</div><div class="ttdoc">Sets MAC address of KNI device. Unconditionally changes MAC of KNI device. If MAC is updated successf...</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a3fd22d62a55612b03481d65bc49fa0cca4950a91c9a09ef0cced588928b501945"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a3fd22d62a55612b03481d65bc49fa0cca4950a91c9a09ef0cced588928b501945">pcpp::KniDevice::INFO_CACHED</a></div><div class="ttdef"><b>Definition:</b> KniDevice.h:148</div></div>
<div class="ttc" id="structpcpp_1_1_kni_device_1_1_kni_device_configuration_html_a2df48dfa7610b8e97f48a46403feb4c4"><div class="ttname"><a href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html#a2df48dfa7610b8e97f48a46403feb4c4">pcpp::KniDevice::KniDeviceConfiguration::name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition:</b> KniDevice.h:238</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_acfeed0b25fa073d8a74b2d29ca218dc6ab03872103ed6bd45be0db9fe29683edd"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#acfeed0b25fa073d8a74b2d29ca218dc6ab03872103ed6bd45be0db9fe29683edd">pcpp::KniDevice::PROMISC_ENABLE</a></div><div class="ttdef"><b>Definition:</b> KniDevice.h:160</div></div>
<div class="ttc" id="structpcpp_1_1_kni_device_1_1_kni_device_configuration_html"><div class="ttname"><a href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html">pcpp::KniDevice::KniDeviceConfiguration</a></div><div class="ttdoc">KNI device initialization data. Used to create new KNI device. Usage of callbacks member or oldCallba...</div><div class="ttdef"><b>Definition:</b> KniDevice.h:231</div></div>
<div class="ttc" id="_mac_address_8h_html"><div class="ttname"><a href="_mac_address_8h.html">MacAddress.h</a></div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_aa16790972282b1abaf1116dc6cd32355"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#aa16790972282b1abaf1116dc6cd32355">pcpp::KniDevice::setLinkState</a></div><div class="ttdeci">bool setLinkState(KniLinkState state)</div><div class="ttdoc">Sets link state of KNI device. Firstly the link information is updated as by call to getLinkState(INF...</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a313c357df59ca65f3c390f9bc2dd98d1"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a313c357df59ca65f3c390f9bc2dd98d1">pcpp::KniDevice::getName</a></div><div class="ttdeci">std::string getName() const</div><div class="ttdef"><b>Definition:</b> KniDevice.h:292</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a84eb855f4a1ca4df14d23374b752edd6"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a84eb855f4a1ca4df14d23374b752edd6">pcpp::KniDevice::setMtu</a></div><div class="ttdeci">bool setMtu(uint16_t mtu)</div><div class="ttdoc">Sets MTU of KNI device. Unconditionally changes MTU of KNI device. If MTU is updated successfully the...</div></div>
<div class="ttc" id="structpcpp_1_1_kni_device_1_1_kni_device_configuration_html_a22df3fac00ba8927f0554bf970e389ac"><div class="ttname"><a href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html#a22df3fac00ba8927f0554bf970e389ac">pcpp::KniDevice::KniDeviceConfiguration::portId</a></div><div class="ttdeci">uint16_t portId</div><div class="ttdef"><b>Definition:</b> KniDevice.h:257</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_acfeed0b25fa073d8a74b2d29ca218dc6"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#acfeed0b25fa073d8a74b2d29ca218dc6">pcpp::KniDevice::KniPromiscuousMode</a></div><div class="ttdeci">KniPromiscuousMode</div><div class="ttdef"><b>Definition:</b> KniDevice.h:155</div></div>
<div class="ttc" id="structpcpp_1_1_kni_device_1_1_kni_device_configuration_html_a367e9fa4227ef174aff1f4c9a0f85ab6"><div class="ttname"><a href="structpcpp_1_1_kni_device_1_1_kni_device_configuration.html#a367e9fa4227ef174aff1f4c9a0f85ab6">pcpp::KniDevice::KniDeviceConfiguration::mtu</a></div><div class="ttdeci">uint16_t mtu</div><div class="ttdef"><b>Definition:</b> KniDevice.h:259</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a85fadba90e945dcbb8915684f862e483"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a85fadba90e945dcbb8915684f862e483">pcpp::KniDevice::receivePackets</a></div><div class="ttdeci">uint16_t receivePackets(MBufRawPacketVector &amp;rawPacketsArr)</div><div class="ttdoc">Receive raw packets from kernel. </div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a9a016df4487ece71c8dc911961a4f329a46ddb813939e1f5ada002c78996649f2"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329a46ddb813939e1f5ada002c78996649f2">pcpp::KniDevice::LINK_UP</a></div><div class="ttdef"><b>Definition:</b> KniDevice.h:140</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a9ea262da8ecc907b834fe7892241578e"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a9ea262da8ecc907b834fe7892241578e">pcpp::KniDevice::stopRequestHandlerThread</a></div><div class="ttdeci">void stopRequestHandlerThread()</div><div class="ttdoc">Explicitly stops request thread for this device if it was running. See description of handleRequests(...</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_aa4d4d8536d5fecfd9ab99a8c92b41971"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#aa4d4d8536d5fecfd9ab99a8c92b41971">pcpp::KniDevice::getPort</a></div><div class="ttdeci">uint16_t getPort() const</div><div class="ttdef"><b>Definition:</b> KniDevice.h:296</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a9a016df4487ece71c8dc911961a4f329a404b3c5554c11081ce5b42f59d43bbd0"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a9a016df4487ece71c8dc911961a4f329a404b3c5554c11081ce5b42f59d43bbd0">pcpp::KniDevice::LINK_NOT_SUPPORTED</a></div><div class="ttdef"><b>Definition:</b> KniDevice.h:134</div></div>
<div class="ttc" id="classpcpp_1_1_mac_address_html"><div class="ttname"><a href="classpcpp_1_1_mac_address.html">pcpp::MacAddress</a></div><div class="ttdef"><b>Definition:</b> MacAddress.h:28</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_a1b7d681b5e1128f4f0c63d71eca31621"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#a1b7d681b5e1128f4f0c63d71eca31621">pcpp::KniDevice::sendPacket</a></div><div class="ttdeci">bool sendPacket(RawPacket &amp;rawPacket)</div><div class="ttdoc">Send a raw packet to kernel. Please notice that if the raw packet isn&amp;#39;t of type MBufRawPacket, a new temp MBufRawPacket will be created and the data will be copied to it. This is necessary to allocate an mbuf which will store the data to be sent. If performance is a critical factor please make sure you send a raw packet of type MBufRawPacket. Please also notice that the mbuf used or allocated in this method isn&amp;#39;t freed by this method, it will be transparently freed by DPDK. </div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_aacdb5298cdb0fa1cc8a3563ef91e2546"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#aacdb5298cdb0fa1cc8a3563ef91e2546">pcpp::KniDevice::stopCapture</a></div><div class="ttdeci">void stopCapture()</div></div>
<div class="ttc" id="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks_html_a935e5aa0c623107a4bf7088be436e68d"><div class="ttname"><a href="structpcpp_1_1_kni_device_1_1_kni_ioctl_callbacks.html#a935e5aa0c623107a4bf7088be436e68d">pcpp::KniDevice::KniIoctlCallbacks::config_mac_address</a></div><div class="ttdeci">int(* config_mac_address)(uint16_t port_id, uint8_t mac_addr[])</div><div class="ttdef"><b>Definition:</b> KniDevice.h:193</div></div>
<div class="ttc" id="classpcpp_1_1_kni_device_html_ab9881c7b4a577be790dfee9e8b6a8e19"><div class="ttname"><a href="classpcpp_1_1_kni_device.html#ab9881c7b4a577be790dfee9e8b6a8e19">pcpp::KniDevice::sendPackets</a></div><div class="ttdeci">uint16_t sendPackets(MBufRawPacket **rawPacketsArr, uint16_t arrLength)</div><div class="ttdoc">Send an array of MBufRawPacket to kernel. Please notice the following:  </div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_1d5e652a4f74c687a1a254f16a4c3d59.html">Pcap++</a></li><li class="navelem"><a class="el" href="dir_24675e680cc699690f9ab00f0f74b528.html">header</a></li><li class="navelem"><a class="el" href="_kni_device_8h.html">KniDevice.h</a></li>
    <li class="footer">Generated on Sat Dec 16 2023 04:11:42 for PcapPlusPlus by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
