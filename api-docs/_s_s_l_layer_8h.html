<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PcapPlusPlus: SSLLayer.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-mobile.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_icon_large.ico"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PcapPlusPlus
   &#160;<span id="projectnumber">19.12</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_s_s_l_layer_8h.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<div class="title">SSLLayer.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="_pointer_vector_8h_source.html">PointerVector.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_layer_8h_source.html">Layer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_s_s_l_common_8h_source.html">SSLCommon.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_s_s_l_handshake_8h_source.html">SSLHandshake.h</a>&quot;</code><br />
</div>
<p><a href="_s_s_l_layer_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpcpp_1_1_s_s_l_layer.html">pcpp::SSLLayer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpcpp_1_1_s_s_l_handshake_layer.html">pcpp::SSLHandshakeLayer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpcpp_1_1_s_s_l_change_cipher_spec_layer.html">pcpp::SSLChangeCipherSpecLayer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpcpp_1_1_s_s_l_alert_layer.html">pcpp::SSLAlertLayer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpcpp_1_1_s_s_l_application_data_layer.html">pcpp::SSLApplicationDataLayer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacepcpp"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepcpp.html">pcpp</a></td></tr>
<tr class="memdesc:namespacepcpp"><td class="mdescLeft">&#160;</td><td class="mdescRight">The main namespace for the PcapPlusPlus lib. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file as well as <a class="el" href="_s_s_l_common_8h.html">SSLCommon.h</a> and <a class="el" href="_s_s_l_handshake_8h.html">SSLHandshake.h</a> provide structures that represent SSL/TLS protocol. Main features:</p><ul>
<li>SSLv3.0 and above are supported. I can add SSLv2.0 if a request for it will come</li>
<li>All SSL/TLS message types are supported (at least all message types I know of)</li>
<li>Above 300 cipher-suites are supported</li>
<li>Only parsing capabilities exist, editing and creation of messages are not supported</li>
<li>X509 certificate parsing is not supported</li>
</ul>
<p><br  />
<br  />
</p>
<p><b>SSL Records:</b> <br  />
</p>
<p>The SSL/TLS protocol has 4 types of records:</p><ul>
<li>Handshake record type</li>
<li>Change cipher spec record type</li>
<li>Alert record type</li>
<li>Application data record type</li>
</ul>
<p>Each record type corresponds to a layer class, and these classes inherit from one base class which is SSLLayer. The SSLLayer is an abstract class which cannot be instantiated. Only its 4 derived classes can be instantiated. This means you'll never see a layer of type SSLLayer, you'll only see the type of the derived classes. A basic class diagram looks like this: </p><pre class="fragment">                                +----------------------------+
                            +---|     SSLHandshakeLayer      | ===&gt; Handshake record type
                            |   +----------------------------+
                            |
                            |   +----------------------------+
                            +---|  SSLChangeCipherSpecLayer  | ===&gt; Change cipher spec record type
                            |   +----------------------------+
                            |
 +------------+             |   +----------------------------+
 |  SSLLayer  |-------------+---|      SSLAlertLayer         | ===&gt; Alert record type
 | (abstract) |             |   +----------------------------+
 +------------+             |
                            |   +----------------------------+
                            +---|   SSLApplicationDataLayer  | ===&gt; Application data record type
                                +----------------------------+</pre><p>A single packet may include several SSL/TLS records, meaning several layer instances of these types, for example:</p>
<pre class="fragment">           +--------------------------+
           |          EthLayer        |
           +--------------------------+
           |          IPv4Layer       |
           +--------------------------+
           |          TcpLayer        |
           +--------------------------+
           |    SSLHandshakeLayer     | \
           +--------------------------+  \
           | SSLChangeCipherSpecLayer | -------- 3 SSL/TLS records in the same packet!
           +--------------------------+  /
           |    SSLHandshakeLayer     | /
           +--------------------------+</pre><p><br  />
<br  />
</p>
<p><b>SSL/TLS Handshake records:</b> <br  />
</p>
<p>The SSL/TLS handshake records are the most complex ones. These type of records encapsulate all messages between client and server during SSL/TLS connection establishment. To accomplish that a SSL/TLS handshake record holds zero or more handshake messages (usually it holds 1 message). These messages form the handshake negotiation between the client and the server. There are several types of handshake messages. Some of the are sent from client to server and some from server to client. PcapPlusPlus supports 11 of these types (definitely the most common ones). For each message there is a designated class which parses the message and exposes its attributes in an easy-to-use manner. Here are the list of supported messages:</p><ul>
<li>Client-hello</li>
<li>Server-hello</li>
<li>Certificate</li>
<li>Hello-request</li>
<li>Server-key-exchange</li>
<li>Client-key-exchange</li>
<li>Certificate-request</li>
<li>Server-hello-done</li>
<li>Certificate-verify</li>
<li>Finished</li>
<li>New-session-ticket</li>
</ul>
<p>All handshake messages classes inherit from a base abstract class: SSLHandshakeMessage which cannot be instantiated. Also, all of them reside in <a class="el" href="_s_s_l_handshake_8h.html">SSLHandshake.h</a>. Following is a simple diagram of these classes:</p>
<pre class="fragment">                                         SSLHandshakeMessage
                                            |
+-------------------------------+           |--- SSLClientHelloMessage        ==&gt; Client-hello message
|       SSLHandshakeLayer       |           |
+-------------------------------+           |--- SSLServerHelloMessage        ==&gt; Server-hello message
| -List of SSLHandshakeMessage  |           |
|     Message1                  |           |---SSLCertificateMessage         ==&gt; Certificate message
|     Message2                  |           |
|     ...                       |           |---SSLHelloRequestMessage        ==&gt; Hello-request message
|                               |           |
+-------------------------------+           |---SSLServerKeyExchangeMessage   ==&gt; Server-key-exchange message
                                            |
                                            |---SSLClientKeyExchangeMessage   ==&gt; Client-key-exchange message
                                            |
                                            |---SSLCertificateRequestMessage  ==&gt; Certificate-request message
                                            |
                                            |---SSLServerHelloDoneMessage     ==&gt; Server-hello-done message
                                            |
                                            |---SSLCertificateVerifyMessage   ==&gt; Certificate-verify message
                                            |
                                            |---SSLFinishedMessage            ==&gt; Finished message
                                            |
                                            |---SSLNewSessionTicketMessage    ==&gt; New-session-ticket message</pre><p>In addition, for all handshake messages which aren't supported in PcapPlusPlus or for encrypted handshake messages There is another class: SSLUnknownMessage</p>
<p><br  />
<br  />
</p>
<p><b>Cipher suites:</b> <br  />
</p>
<p>Cipher suites are named combinations of authentication, encryption, message authentication code (MAC) and key exchange algorithms used to negotiate the security settings for a network connection using SSL/TLS. There are many known cipher-suites. PcapPlusPlus support above 300 of them, according to this list: <a href="http://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml">http://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml</a> There is a designated class in PcapPlusPlus called SSLCipherSuite which represents the cipher-suites and provides access to their attributes. Then there is a static instance of this class for each one of the supported cipher-suites. This means there are 300+ static instances of SSLCipherSuite representing the different cipher suites. The user can access them through static methods in SSLCipherSuite or from client-hello and server-hello messages where they appear</p>
<p><br  />
<br  />
</p>
<p><b>SSL/TLS extensions:</b> <br  />
</p>
<p>SSL/TLS handshake messages, specifically client-hello and server-hello usually include extensions. There are various types of extensions - some are more broadly used, some are less. In PcapPlusPlus there is a base class for all extensions: SSLExtension. This class is instantiable and represents a generic extension, which means extension data isn't parsed and given to the user as raw data. Currently there is only one extension that is fully parsed which is server-name-indication. This extension has a class of his own named SSLServerNameIndicationExtension which inherits from SSLExtension and does the parsing for this specific extension. All other extensions aren't parsed and are represented by instance of SSLExtension. Access to extensions is done through the handshake messages classes, specifically SSLClientHelloMessage and SSLServerHelloMessage </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_de86beb0baec615108c189a95e2985e8.html">PcapPlusPlus</a></li><li class="navelem"><a class="el" href="dir_5651890ad0082dbf4dbb18c410c015c9.html">Dist</a></li><li class="navelem"><a class="el" href="dir_00034babc01e96e2748c521d6645ae1d.html">header</a></li><li class="navelem"><a class="el" href="_s_s_l_layer_8h.html">SSLLayer.h</a></li>
    <li class="footer">Generated on Mon Dec 2 2019 23:53:21 for PcapPlusPlus by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
