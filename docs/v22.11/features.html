<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-v22.11 docs-doc-page docs-doc-id-features" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Feature Overview | PcapPlusPlus</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://pcapplusplus.github.io/docs/v22.11/features"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="v22.11"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v22.11"><meta data-rh="true" name="docsearch:version" content="v22.11"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v22.11"><meta data-rh="true" property="og:title" content="Feature Overview | PcapPlusPlus"><meta data-rh="true" name="description" content="Packet capture"><meta data-rh="true" property="og:description" content="Packet capture"><link data-rh="true" rel="icon" href="/img/logo/logo_icon_large.ico"><link data-rh="true" rel="canonical" href="https://pcapplusplus.github.io/docs/v22.11/features"><link data-rh="true" rel="alternate" href="https://pcapplusplus.github.io/docs/v22.11/features" hreflang="en"><link data-rh="true" rel="alternate" href="https://pcapplusplus.github.io/docs/v22.11/features" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://31QB400Q4J-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-74037205-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>



<link rel="search" type="application/opensearchdescription+xml" title="PcapPlusPlus" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.d4faa30b.css">
<script src="/assets/js/runtime~main.dd71c10e.js" defer="defer"></script>
<script src="/assets/js/main.61f378ad.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo/logo_color.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo/logo_color.png" alt="PcapPlusPlus" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo/logo_color.png" alt="PcapPlusPlus" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/v22.11/quickstart">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/v22.11/features">Features</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/v22.11/api">API</a><a class="navbar__item navbar__link" href="/community">Community</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/v22.11/features">v22.11</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/features">Next</a></li><li><a class="dropdown__link" href="/docs/features">v25.05</a></li><li><a class="dropdown__link" href="/docs/v24.09/features">v24.09</a></li><li><a class="dropdown__link" href="/docs/v23.09/features">v23.09</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/v22.11/features">v22.11</a></li><li><a class="dropdown__link" href="/docs/v22.05/features">v22.05</a></li><li><a class="dropdown__link" href="/docs/v21.11/features">v21.11</a></li><li><a class="dropdown__link" href="/versions">All versions</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://groups.google.com/d/forum/pcapplusplus-support" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" title="PcapPlusPlus Google Group">Google Group<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="mailto:pcapplusplus@gmail.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" title="Send us an email">Email<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://stackoverflow.com/questions/tagged/pcapplusplus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" title="PcapPlusPlus tag on StackOverflow">StackOverflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://twitter.com/seladb" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" title="PcapPlusPlus on Twitter">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/seladb/PcapPlusPlus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" title="PcapPlusPlus on GitHub">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/v22.11/quickstart">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/v22.11/install">Installation</a><button aria-label="Expand sidebar category &#x27;Installation&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/v22.11/features">Feature Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/v22.11/dpdk">DPDK Support</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/v22.11/tutorials">Tutorials</a><button aria-label="Expand sidebar category &#x27;Tutorials&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/v22.11/platforms">Supported platforms</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/v22.11/examples">Example Apps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/v22.11/benchmark">Benchmarks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/v22.11/tests">Running Tests</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/v22.11/api">API Reference</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->PcapPlusPlus<!-- --> <b>v22.11</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/features">latest version</a></b> (<!-- -->v25.05<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Feature Overview</span><meta itemprop="position" content="1"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v22.11</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Feature Overview</h1></header>
<!-- -->
<div class="tableOfContentsInline_prmo"><ul class="table-of-contents"><li><a href="#packet-capture">Packet capture</a></li><li><a href="#packet-parsing-and-crafting">Packet parsing and crafting</a></li><li><a href="#read-and-write-packets-fromto-files">Read and write packets from/to files</a></li><li><a href="#dpdk-support">DPDK support</a></li><li><a href="#pf_ring-support">PF_RING support</a></li><li><a href="#packet-reassembly">Packet reassembly</a></li><li><a href="#packet-filtering">Packet filtering</a></li><li><a href="#tls-fingerprinting">TLS Fingerprinting</a></li><li><a href="#supported-network-protocols">Supported network protocols</a></li><li><a href="#license">License</a></li></ul></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="packet-capture">Packet capture<a href="#packet-capture" class="hash-link" aria-label="Direct link to Packet capture" title="Direct link to Packet capture">​</a></h2>
<p>Packet capture (A.K.A packet sniffing or network tapping) is the process of intercepting and logging traffic that passes over a digital network or part of a network (taken from <a href="https://en.wikipedia.org/wiki/Packet_analyzer" target="_blank" rel="noopener noreferrer">Wikipedia</a>). It is one of the most important and popular features of PcapPlusPlus and it is what PcapPlusPlus is basically all about.</p>
<p>There are multiple packet capture engines out there, the most popular are <a href="https://www.tcpdump.org/" target="_blank" rel="noopener noreferrer">libpcap</a>, <a href="https://www.winpcap.org/" target="_blank" rel="noopener noreferrer">WinPcap</a> (which is libpcap for Windows), <a href="https://nmap.org/npcap/" target="_blank" rel="noopener noreferrer">Npcap</a> (WinPcap&#x27;s successor), <a href="https://www.dpdk.org/" target="_blank" rel="noopener noreferrer">Intel DPDK</a>, <a href="https://www.ntop.org/products/packet-capture/pf_ring/" target="_blank" rel="noopener noreferrer">ntop&#x27;s PF_RING</a> and <a href="https://en.wikipedia.org/wiki/Network_socket#Raw_socket" target="_blank" rel="noopener noreferrer">raw sockets</a>. Each engine has different strengths, purposes and features, works on different platforms and obviously has different APIs and setup process. Most of them are written in C (to achieve the best performance) and don&#x27;t expose a C++ interface.</p>
<p>PcapPlusPlus aims to create a consolidated and easy-to-use C++ API for all of these engines which simplifies their complexity and provides a common infrastructure for capturing, processing, analyzing and forging of network packets.</p>
<p>Here is a list of of the packet capture engines currently supported:</p>
<ul>
<li><a href="https://www.tcpdump.org/" target="_blank" rel="noopener noreferrer">libpcap</a> live capture (on Linux, MacOS, Android, FreeBSD)</li>
<li><a href="https://www.winpcap.org/" target="_blank" rel="noopener noreferrer">WinPcap</a>/<a href="https://nmap.org/npcap/" target="_blank" rel="noopener noreferrer">Npcap</a> live capture (on Windows)</li>
<li><a href="https://www.dpdk.org/" target="_blank" rel="noopener noreferrer">Intel DPDK</a> (on Linux)</li>
<li><a href="https://www.ntop.org/products/packet-capture/pf_ring/" target="_blank" rel="noopener noreferrer">ntop&#x27;s Vanilla PF_RING</a> (on Linux)</li>
<li><a href="https://www.winpcap.org/docs/docs_412/html/group__remote.html" target="_blank" rel="noopener noreferrer">WinPcap Remote capture</a> (on Windows)</li>
</ul>
<p>The main features provided for each one are:</p>
<ul>
<li>Browse all interfaces available on the machine</li>
<li>Capture network traffic on a specific interface</li>
<li>Send packets to the network</li>
<li>Filter packets</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="whats-next">What&#x27;s next?<a href="#whats-next" class="hash-link" aria-label="Direct link to What&#x27;s next?" title="Direct link to What&#x27;s next?">​</a></h3>
<p>You can find out more information in the <a href="/docs/v22.11/api">API documentation</a>, <a href="/docs/v22.11/tutorials/intro">tutorial pages</a> and browse through the code of the <a href="/docs/v22.11/examples">example apps</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="packet-parsing-and-crafting">Packet parsing and crafting<a href="#packet-parsing-and-crafting" class="hash-link" aria-label="Direct link to Packet parsing and crafting" title="Direct link to Packet parsing and crafting">​</a></h2>
<p>PcapPlusPlus provides advanced capabilities for packet analysis which include:</p>
<ul>
<li>Packet parsing, which is a detailed analysis of the protocols and layers of a packet</li>
<li>Packet crafting which is generation and editing of network packets</li>
</ul>
<p>A large variety of network protocols are supported, see the full list <a href="#supported-network-protocols">here</a>.</p>
<p>Packets can be analyzed from any source including those captured from the network, packets stored in PCAP/PCAPNG files, and more.
The design of PcapPlusPlus allows similar analysis capabilities for each packet, regardless of where it came from. For example, you can write the same code for parsing packets that are captured using DPDK, libpcap, WinPcap/Npcap, raw sockets or read from a PCAP/PCAPNG file. Same goes for packet crafting.</p>
<p>Consider this simple code snippet that shows how to read a packet from a PCAP file, parse it, identify if it&#x27;s an IPv4 packet and print the source and dest IP addresses:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;iostream&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&quot;IPv4Layer.h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&quot;Packet.h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&quot;PcapFileDevice.h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> argc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// open a pcap file for reading</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pcpp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">PcapFileReaderDevice </span><span class="token function" style="color:#d73a49">reader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;1_packet.pcap&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">reader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cerr </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Error opening the pcap file&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// read the first packet from the file (in this case the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// file contains only one packet)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pcpp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">RawPacket rawPacket</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">reader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getNextPacket</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rawPacket</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cerr </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Couldn&#x27;t read the first packet in the file&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// parse the raw packet into a parsed packet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pcpp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Packet </span><span class="token function" style="color:#d73a49">parsedPacket</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">rawPacket</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// check if it&#x27;s an IPv4 packet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parsedPacket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isPacketOfType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pcpp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">IPv4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// extract source and dest IPs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pcpp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">IPv4Address srcIP </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> parsedPacket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getLayerOfType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">getSrcIPv4Address</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pcpp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">IPv4Address destIP </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> parsedPacket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getLayerOfType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">getDstIPv4Address</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// print source and dest IPs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Source IP is &#x27;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> srcIP </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;; &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Dest IP is &#x27;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> destIP </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// close the file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="read-and-write-packets-fromto-files">Read and write packets from/to files<a href="#read-and-write-packets-fromto-files" class="hash-link" aria-label="Direct link to Read and write packets from/to files" title="Direct link to Read and write packets from/to files">​</a></h2>
<p>Network packets can be stored in files, usually for offline analysis. <a href="https://wiki.wireshark.org/Development/LibpcapFileFormat" target="_blank" rel="noopener noreferrer">PCAP</a> and <a href="https://github.com/pcapng/pcapng" target="_blank" rel="noopener noreferrer">PCAPNG</a> are the two most popular file formats and both are supported in PcapPlusPlus. In addition the <a href="https://datatracker.ietf.org/doc/html/rfc1761" target="_blank" rel="noopener noreferrer">SNOOP</a> file format is supported for read-only.</p>
<p>The main features include:</p>
<ul>
<li>Read packets from PCAP/PCAPNG/SNOOP files</li>
<li>Create new PCAP/PCAPNG files and write packets to them</li>
<li>Use the <a href="#packet-filtering">packet filtering mechanism</a> to read or write only packets that match the filter</li>
<li>Append packets to existing PCAP/PCAPNG files</li>
<li>Write compressed PCAPNG files using <a href="https://facebook.github.io/zstd/" target="_blank" rel="noopener noreferrer">Zstd</a> compression in real time (OPTIONAL and requires building with Zstd)</li>
</ul>
<p>Consider this simple code snippet that shows how to open a PCAP file for reading and another PCAPNG file for writing, and then read all packets from the PCAP file and write them to the PCAPNG file:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// create a pcap file reader</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcpp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">PcapFileReaderDevice </span><span class="token function" style="color:#d73a49">pcapReader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;input.pcap&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcapReader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// create a pcapng file writer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcpp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">PcapNgFileWriterDevice </span><span class="token function" style="color:#d73a49">pcapNgWriter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;output.pcapng&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcapNgWriter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// raw packet object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcpp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">RawPacket rawPacket</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// read packets from pcap reader and write pcapng writer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pcapReader</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">getNextPacket</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rawPacket</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pcapNgWriter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">writePacket</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rawPacket</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcapNgReader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//These will close when going out of scope</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcapNgWriter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//or you may close them manually</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For more information please refer to the <a href="/docs/v22.11/tutorials/read-write-pcap">Read/Write Pcap Files tutorial</a>, look at the <a href="/docs/v22.11/api">API documentation</a> or browse through the code of the <a href="/docs/v22.11/examples">example apps</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="readingwriting-pcapng-files-with-compression">Reading/Writing PCAPNG files with compression<a href="#readingwriting-pcapng-files-with-compression" class="hash-link" aria-label="Direct link to Reading/Writing PCAPNG files with compression" title="Direct link to Reading/Writing PCAPNG files with compression">​</a></h3>
<p>Zstd streaming compression is only supported when working with pcapng files. To enable this feature you must build PcapPlusPlus with Zstd support. For more guidance on building PcapPlusPlus see the <a href="/docs/v22.11/install">build instructions per platform</a>.</p>
<p>Once you have a working build modifying your code to start enabling compression is fast and easy!</p>
<p>When writing PCAPNG files, to enable streaming compression all you need to do is add a second integer argument when constructing your writer. The integer should be between 0-10 and it specifies the compression level. Values outside this range will be clamped. A value of zero, which is also the default, indicates to skip compression. A value of 10 would indicate use maximum compression. For most scenarios a value of 5 or less should be adequate.</p>
<p>For reading compressed PCAPNG files the only requirement is that the file name extension must terminate in <code>.zstd</code>. If a compressed file is supplied to the reader without the <code>.zstd</code> extension the file will fail to load. Currently, APPENDING to a compressed file is NOT supported!</p>
<p>If you write code enabling compression, by adding a compression level to your writer constructor, but use a build of PcapPlusPlus without compression support, everything will work just fine and the compression will be skipped/ignored and normal PCAPNG files will be generated/read.</p>
<p>There is a tradeoff between compression speed and compression efficiency. A compression value of 10 will yield the most compression but be slower, while a value of 1 will yield the least compression but be fastest. Depending upon your capture rates and data size you can tune this number to fit your needs.</p>
<p>Since Zstd is designed to support fast and efficient streaming compression most users should not see any noticeable performance impact when enabling compression. Exact savings from compression will always vary based upon the input data, however; in one test case an uncompressed PCAPNG file of 140MB was duplicated with a compression level of 5 to yield a compressed PCAPNG file of only 40MB giving about 4x space savings! Note that the compression is performed while the file is written so you will not notice any delay when closing the file or a long processing time like you work normally experience when compressing an existing file.</p>
<p>Some example compression code:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// create a pcapng file reader</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcpp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">PcapNgFileReaderDevice </span><span class="token function" style="color:#d73a49">reader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;input.pcap.zstd&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//Notice the Zstd extension</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                                           </span><span class="token comment" style="color:#999988;font-style:italic">//This is required for proper loading</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// create a pcapng file writer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcpp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">PcapNgFileWriterDevice </span><span class="token function" style="color:#d73a49">writer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;output.pcapng.zstd&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//The second integer argument 5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcapNgWriter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                                           </span><span class="token comment" style="color:#999988;font-style:italic">//is the compression level to use</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// read packets from pcapng reader and write pcapng writer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">reader</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">getNextPacket</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rawPacket</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  writer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">writePacket</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rawPacket</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dpdk-support">DPDK support<a href="#dpdk-support" class="hash-link" aria-label="Direct link to DPDK support" title="Direct link to DPDK support">​</a></h2>
<p>The Data Plane Development Kit (DPDK) is a set of data plane libraries and network interface controller drivers for fast packet processing, currently managed as an open-source project under the Linux Foundation. The DPDK provides a programming framework for x86, ARM, and PowerPC processors and enables faster development of high speed data packet networking applications (taken from <a href="https://en.wikipedia.org/wiki/Data_Plane_Development_Kit" target="_blank" rel="noopener noreferrer">Wikipedia</a>).</p>
<p>DPDK provides packet processing in line rate using kernel bypass for a large range of network interface cards. Notice that not every NIC supports DPDK as the NIC needs to support the kernel bypass feature. You can read more about DPDK in <a href="https://www.dpdk.org/" target="_blank" rel="noopener noreferrer">DPDK&#x27;s web-site</a> and get a list of supported NICs <a href="http://core.dpdk.org/supported/" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p>As DPDK API is written in C, PcapPlusPlus wraps its main functionality in easy-to-use C++ wrappers which have minimum impact on performance and packet processing rate. In addition it brings DPDK to the PcapPlusPlus framework and APIs so you can use DPDK together with other PcapPlusPlus features such as packet analysis, etc.</p>
<p>You can find more information about setting up DPDK and the API in <a href="/docs/v22.11/dpdk">DPDK support page</a> and also in <a href="/docs/v22.11/tutorials/dpdk">DPDK tutorial</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pf_ring-support">PF_RING support<a href="#pf_ring-support" class="hash-link" aria-label="Direct link to PF_RING support" title="Direct link to PF_RING support">​</a></h2>
<p>PF_RING™ is a new type of network socket that dramatically improves the packet capture speed. It&#x27;s providing high-speed packet capture, filtering and analysis (taken from <a href="https://www.ntop.org/products/packet-capture/pf_ring/" target="_blank" rel="noopener noreferrer">ntop&#x27;s website</a>).</p>
<p>PcapPlusPlus provides a clean and simple C++ wrapper API for <a href="https://www.ntop.org/products/packet-capture/pf_ring/" target="_blank" rel="noopener noreferrer">Vanilla PF_RING</a>. Currently only Vanilla PF_RING is supported which provides significant performance improvement in comparison to libpcap or Linux kernel, but <a href="https://www.ntop.org/products/packet-capture/pf_ring/pf_ring-zc-zero-copy/" target="_blank" rel="noopener noreferrer">PF_RING Zero Copy</a> (which allows kernel bypass and zero-copy of packets from NIC to user-space) is not yet supported.</p>
<p>In order to compile PcapPlusPlus with PF_RING you need to:</p>
<ul>
<li>Download PF_RING from <a href="https://www.ntop.org/get-started/download/#PF_RING" target="_blank" rel="noopener noreferrer">ntop&#x27;s web-site</a></li>
<li>Once PF_RING is compiled successfully, you need to run PcapPlusPlus&#x27;s <code>configure-linux.sh</code> script and type &quot;y&quot; in &quot;Compile PcapPlusPlus with PF_RING?&quot;</li>
<li>Then you can compile PcapPlusPlus as usual</li>
<li>Before you activate any PcapPlusPlus application that uses PF_RING, don&#x27;t forget to enable PF_RING kernel module. If you forget to do that, PcapPlusPlus will output an - appropriate error on startup which will remind you:</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> insmod </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">PF_RING_LOCATION</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/kernel/pf_ring.ko</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="packet-reassembly">Packet reassembly<a href="#packet-reassembly" class="hash-link" aria-label="Direct link to Packet reassembly" title="Direct link to Packet reassembly">​</a></h2>
<p>Network protocols often need to transport large chunks of data which are complete in themselves, e.g. when transferring a file. The underlying protocol might not be able to handle that chunk size (e.g. limitation of the network packet size), or is stream-based like TCP, which doesn’t know data chunks at all.</p>
<p>In that case the network protocol has to handle the chunk boundaries itself and (if required) spread the data over multiple packets. It obviously also needs a mechanism to determine the chunk boundaries on the receiving side.</p>
<p>This mechanism is called reassembly, although a specific protocol specification might use a different term for this (e.g. desegmentation, defragmentation, etc).</p>
<p>(this description is taken from <a href="https://www.wireshark.org/docs/wsug_html_chunked/ChAdvReassemblySection.html" target="_blank" rel="noopener noreferrer">Wireshark documentation</a>).</p>
<p>PcapPlusPlus currently supports two types of packets reassembly:</p>
<ul>
<li>IPv4 and IPv6 defragmentation which is a Layer 3 (Network layer) packet reassembly. You can read more about IP fragmentation <a href="https://en.wikipedia.org/wiki/IP_fragmentation" target="_blank" rel="noopener noreferrer">here</a>. To get more information about how it works and the API to use it please refer to the <a href="/docs/v22.11/api">API documentation</a> and browse through the code of the <a href="/docs/v22.11/examples#ipdefragutil">IPDefragUtil</a> and <a href="/docs/v22.11/examples#ipfragutil">IPFragUtil</a> example apps</li>
<li>TCP reassembly which is a Layer 4 (Transport layer) packet reassembly. To get more information on how it works and the API to use it please refer to the <a href="/docs/v22.11/api">API documentation</a> and browse through the code of the <a href="/docs/v22.11/examples#tcpreassembly">TcpReassembly</a> example app</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="packet-filtering">Packet filtering<a href="#packet-filtering" class="hash-link" aria-label="Direct link to Packet filtering" title="Direct link to Packet filtering">​</a></h2>
<p>Most packet capture engines contain packet filtering capabilities. In order to set the filters there should be a known syntax user can use. The most popular syntax is <a href="http://en.wikipedia.org/wiki/Berkeley_Packet_Filter" target="_blank" rel="noopener noreferrer">Berkeley Packet Filter (BPF)</a>. Detailed explanation of the syntax can be found <a href="http://www.tcpdump.org/manpages/pcap-filter.7.html" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p>The challenge with BPF is that it is too complicated and poorly documented. When compiling BPF filters you often get syntax errors that are hard to understand and debug. Our experience with BPF was not good, so we decided to include in PcapPlusPlus a filter mechanism which is more structured, easier to understand and less error-prone by creating classes that represent filters. Each possible filter phrase is represented by a class. The filter, in the end, is that class.</p>
<p>Consider the following code snippet for creating the filter <code>src ip 1.1.1.1 and dst port 80</code> and setting it up on a packet capture device:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// create a filter instance to capture only traffic on port 80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcpp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">PortFilter </span><span class="token function" style="color:#d73a49">portFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">80</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pcpp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">DST</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// create a filter instance to capture only TCP traffic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcpp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">IPFilter </span><span class="token function" style="color:#d73a49">ipFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;1.1.1.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pcpp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SRC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// create an AND filter to combine both filters - capture only TCP traffic on port 80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcpp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AndFilter andFilter</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">andFilter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">portFilter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">andFilter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">ipFilter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// set the filter on the device</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dev</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">setFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">andFilter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can read more in the <a href="/api-docs/v22.11/_pcap_filter_8h.html"><code>PcapFilter.h</code> API documentation</a> and in the <a href="/docs/v22.11/tutorials/capture-packets#filtering-packets">capture packets tutorial</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tls-fingerprinting">TLS Fingerprinting<a href="#tls-fingerprinting" class="hash-link" aria-label="Direct link to TLS Fingerprinting" title="Direct link to TLS Fingerprinting">​</a></h2>
<p>TLS Fingerprinting is a technique that extracts specific parameters from TLS handshake messages such as ClientHello and ServerHello. Most applications that need network access (such as browsers, apps, etc.) have a unique combination(s) of these parameters while making network connections, so this technique can be used to fingerprint those applications. By using a database of curated fingerprints it&#x27;s possible to detect network traffic anomalies which can point to malware, security vulnerabilities or other undesired behavior. It can also be used for network visibility, for example identify popular applications, detect applications that use weak encryption, etc. This method of fingerprinting is very effective because TLS handshake is often done in lower levels of the application hence it&#x27;s difficult to forge or tamper with it.</p>
<p>The primary concept for TLS fingerprinting came from <a href="https://blog.squarelemon.com/tls-fingerprinting/" target="_blank" rel="noopener noreferrer">Lee Brotherston’s 2015 research</a> (<a href="https://github.com/LeeBrotherston/tls-fingerprinting" target="_blank" rel="noopener noreferrer">GitHub repo</a>). Following his work more articles and implementations came out, one of them was <a href="https://engineering.salesforce.com/tls-fingerprinting-with-ja3-and-ja3s-247362855967" target="_blank" rel="noopener noreferrer">Salesforce JA3</a> (<a href="https://github.com/salesforce/ja3" target="_blank" rel="noopener noreferrer">GitHub repo</a>) which implements TLS fingerprinting in Python and <a href="https://www.zeekurity.org/" target="_blank" rel="noopener noreferrer">Zeek</a>. This project introduced two types of TLS fingerprinting: JA3 which is the &quot;traditional&quot; ClientHello fingerprinting (which is the more common and well-known method), and JA3S which is ServerHello fingerprinting.</p>
<p>PcapPlusPlus contains an implementation of JA3 and JA3S in C++. There are not a lot of C++ implementations for TLS fingerprinting and we thought this can be a good feature for PcapPlusPlus as it already analyzes TLS network traffic.</p>
<p>Using TLS fingerprinting in PcapPlusPlus is very easy, here is a quick example:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Get the handshake layer and extract the ClientHello message</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcpp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SSLHandshakeLayer</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> sslHandshakeLayer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> parsedPacket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token generic-function function" style="color:#d73a49">getLayerOfType</span><span class="token generic-function generic class-name operator" style="color:#393A34">&lt;</span><span class="token generic-function generic class-name">pcpp</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name">SSLHandshakeLayer</span><span class="token generic-function generic class-name operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcpp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SSLClientHelloMessage</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> clientHelloMessage </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sslHandshakeLayer</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token generic-function function" style="color:#d73a49">getHandshakeMessageOfType</span><span class="token generic-function generic class-name operator" style="color:#393A34">&lt;</span><span class="token generic-function generic class-name">pcpp</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name">SSLClientHelloMessage</span><span class="token generic-function generic class-name operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Extract the TLS fingerprint from the ClientHello message</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcpp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SSLClientHelloMessage</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ClientHelloTLSFingerprint tlsFingerprint </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clientHelloMessage</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">generateTLSFingerprint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">pair</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> tlsFingerprintStringAndMD5 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tlsFingerprint</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toStringAndMD5</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Print the full fingerprint and an MD5 version of it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ClientHello (JA3) TLS fingerprint: &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> tlsFingerprintStringAndMD5</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">first</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;; MD5: &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> tlsFingerprintStringAndMD5</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">second</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ServerHello TLS fingerprinting (JA3S) is almost similar but for <code>pcpp::SSLServerHelloMessage</code> messages.</p>
<p>To learn more please take a look at the <a href="https://github.com/seladb/PcapPlusPlus/tree/%7B%7Bsite.github_label%7D%7D/Examples/TLSFingerprinting" target="_blank" rel="noopener noreferrer">TLS fingerprinting example</a> in PcapPlusPlus GitHub repo which demonstrates how to collect ClientHello and ServerHello fingerprints from live traffic or pcap files, write them to an output file and display various statistics.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="supported-network-protocols">Supported network protocols<a href="#supported-network-protocols" class="hash-link" aria-label="Direct link to Supported network protocols" title="Direct link to Supported network protocols">​</a></h2>
<p>PcapPlusPlus currently supports parsing, editing and generation of packets of the following protocols:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-link-layer-l2">Data Link Layer (L2)<a href="#data-link-layer-l2" class="hash-link" aria-label="Direct link to Data Link Layer (L2)" title="Direct link to Data Link Layer (L2)">​</a></h3>
<ol>
<li>Ethernet II</li>
<li>IEEE 802.3 Ethernet</li>
<li>LLC (Only BPDU supported)</li>
<li>Null/Loopback</li>
<li>Packet trailer (a.k.a footer or padding)</li>
<li>PPPoE</li>
<li>SLL (Linux cooked capture)</li>
<li>STP - parsing only (no editing capabilities)</li>
<li>VLAN</li>
<li>VXLAN</li>
<li>Wake on LAN (WoL)</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-layer-l3">Network Layer (L3)<a href="#network-layer-l3" class="hash-link" aria-label="Direct link to Network Layer (L3)" title="Direct link to Network Layer (L3)">​</a></h3>
<ol start="12">
<li>ARP</li>
<li>GRE</li>
<li>ICMP</li>
<li>ICMPv6</li>
<li>IGMP (IGMPv1, IGMPv2 and IGMPv3 are supported)</li>
<li>IPv4</li>
<li>IPv6</li>
<li>MPLS</li>
<li>NDP</li>
<li>Raw IP (IPv4 &amp; IPv6)</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="transport-layer-l4">Transport Layer (L4)<a href="#transport-layer-l4" class="hash-link" aria-label="Direct link to Transport Layer (L4)" title="Direct link to Transport Layer (L4)">​</a></h3>
<ol start="22">
<li>GTP (v1)</li>
<li>IPSec AH &amp; ESP - parsing only (no editing capabilities)</li>
<li>TCP</li>
<li>UDP</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="session-layer-l5">Session Layer (L5)<a href="#session-layer-l5" class="hash-link" aria-label="Direct link to Session Layer (L5)" title="Direct link to Session Layer (L5)">​</a></h3>
<ol start="26">
<li>SDP</li>
<li>SIP</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="presentation-layer-l6">Presentation Layer (L6)<a href="#presentation-layer-l6" class="hash-link" aria-label="Direct link to Presentation Layer (L6)" title="Direct link to Presentation Layer (L6)">​</a></h3>
<ol start="28">
<li>SSL/TLS - parsing only (no editing capabilities)</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="application-layer-l7">Application Layer (L7)<a href="#application-layer-l7" class="hash-link" aria-label="Direct link to Application Layer (L7)" title="Direct link to Application Layer (L7)">​</a></h3>
<ol start="29">
<li>BGP (v4)</li>
<li>DHCP</li>
<li>DHCPv6</li>
<li>DNS</li>
<li>FTP</li>
<li>HTTP headers (request &amp; response)</li>
<li>NTP (v3, v4)</li>
<li>Radius</li>
<li>SOME/IP</li>
<li>SSH - parsing only (no editing capabilities)</li>
<li>Telnet - parsing only (no editing capabilities)</li>
<li>Generic payload</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="license">License<a href="#license" class="hash-link" aria-label="Direct link to License" title="Direct link to License">​</a></h2>
<p>PcapPlusPlus is released under the <a href="https://unlicense.org/" target="_blank" rel="noopener noreferrer">Unlicense license</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/PcapPlusPlus/pcapplusplus.github.io/edit/master/versioned_docs/version-v22.11/features.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/v22.11/install/freebsd"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Build on FreeBSD</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/v22.11/dpdk"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">DPDK Support</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#packet-capture" class="table-of-contents__link toc-highlight">Packet capture</a><ul><li><a href="#whats-next" class="table-of-contents__link toc-highlight">What&#39;s next?</a></li></ul></li><li><a href="#packet-parsing-and-crafting" class="table-of-contents__link toc-highlight">Packet parsing and crafting</a></li><li><a href="#read-and-write-packets-fromto-files" class="table-of-contents__link toc-highlight">Read and write packets from/to files</a><ul><li><a href="#readingwriting-pcapng-files-with-compression" class="table-of-contents__link toc-highlight">Reading/Writing PCAPNG files with compression</a></li></ul></li><li><a href="#dpdk-support" class="table-of-contents__link toc-highlight">DPDK support</a></li><li><a href="#pf_ring-support" class="table-of-contents__link toc-highlight">PF_RING support</a></li><li><a href="#packet-reassembly" class="table-of-contents__link toc-highlight">Packet reassembly</a></li><li><a href="#packet-filtering" class="table-of-contents__link toc-highlight">Packet filtering</a></li><li><a href="#tls-fingerprinting" class="table-of-contents__link toc-highlight">TLS Fingerprinting</a></li><li><a href="#supported-network-protocols" class="table-of-contents__link toc-highlight">Supported network protocols</a><ul><li><a href="#data-link-layer-l2" class="table-of-contents__link toc-highlight">Data Link Layer (L2)</a></li><li><a href="#network-layer-l3" class="table-of-contents__link toc-highlight">Network Layer (L3)</a></li><li><a href="#transport-layer-l4" class="table-of-contents__link toc-highlight">Transport Layer (L4)</a></li><li><a href="#session-layer-l5" class="table-of-contents__link toc-highlight">Session Layer (L5)</a></li><li><a href="#presentation-layer-l6" class="table-of-contents__link toc-highlight">Presentation Layer (L6)</a></li><li><a href="#application-layer-l7" class="table-of-contents__link toc-highlight">Application Layer (L7)</a></li></ul></li><li><a href="#license" class="table-of-contents__link toc-highlight">License</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/install">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/features">Features</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tutorials">Tutorials</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/dpdk">DPDK</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/examples">Example Apps</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/api">API Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/seladb/PcapPlusPlus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/seladb" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/pcapplusplus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://groups.google.com/d/forum/pcapplusplus-support" target="_blank" rel="noopener noreferrer" class="footer__link-item">Google Group<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="mailto:pcapplusplus@gmail.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Email<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/community#contribute">Contribute</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/versions">Releases</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/benchmark">Benchmarks</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/features#license">License</a></li><li class="footer__item"><a href="https://github.com/PcapPlusPlus/pcapplusplus.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Web-site GitHub Repo<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 seladb. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>